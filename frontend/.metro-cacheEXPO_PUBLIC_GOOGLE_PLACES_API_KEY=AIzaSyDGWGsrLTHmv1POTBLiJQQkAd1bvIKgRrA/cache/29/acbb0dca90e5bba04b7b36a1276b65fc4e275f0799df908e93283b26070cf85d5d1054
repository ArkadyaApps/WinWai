{"dependencies":[{"name":"react","data":{"asyncType":null,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":66,"index":66}}],"key":"a4EMkKqamYWCMMPV7UeQlqGQ+ks="}},{"name":"./AuthRequest","data":{"asyncType":null,"locs":[{"start":{"line":2,"column":0,"index":67},"end":{"line":2,"column":44,"index":111}}],"key":"zl/HlNVYtYFF7IasgcJVdiwRObc="}},{"name":"./Discovery","data":{"asyncType":null,"locs":[{"start":{"line":3,"column":0,"index":112},"end":{"line":3,"column":52,"index":164}}],"key":"fxuPRqa/4xVsdR7NFqX53ecUs4g="}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.useAuthRequest = useAuthRequest;\n  exports.useAuthRequestResult = useAuthRequestResult;\n  exports.useAutoDiscovery = useAutoDiscovery;\n  exports.useLoadedAuthRequest = useLoadedAuthRequest;\n  var _react = require(_dependencyMap[0], \"react\");\n  var _AuthRequest = require(_dependencyMap[1], \"./AuthRequest\");\n  var _Discovery = require(_dependencyMap[2], \"./Discovery\");\n  // @needsAudit\n  /**\n   * Given an OpenID Connect issuer URL, this will fetch and return the [`DiscoveryDocument`](#discoverydocument)\n   * (a collection of URLs) from the resource provider.\n   *\n   * @param issuerOrDiscovery URL using the `https` scheme with no query or fragment component that the OP asserts as its Issuer Identifier.\n   * @return Returns `null` until the [`DiscoveryDocument`](#discoverydocument) has been fetched from the provided issuer URL.\n   *\n   * @example\n   * ```ts\n   * const discovery = useAutoDiscovery('https://example.com/auth');\n   * ```\n   */\n  function useAutoDiscovery(issuerOrDiscovery) {\n    const [discovery, setDiscovery] = (0, _react.useState)(null);\n    (0, _react.useEffect)(() => {\n      let isAllowed = true;\n      (0, _Discovery.resolveDiscoveryAsync)(issuerOrDiscovery).then(discovery => {\n        if (isAllowed) {\n          setDiscovery(discovery);\n        }\n      });\n      return () => {\n        isAllowed = false;\n      };\n    }, [issuerOrDiscovery]);\n    return discovery;\n  }\n  function useLoadedAuthRequest(config, discovery, AuthRequestInstance) {\n    const [request, setRequest] = (0, _react.useState)(null);\n    const scopeString = (0, _react.useMemo)(() => config.scopes?.join(','), [config.scopes]);\n    const extraParamsString = (0, _react.useMemo)(() => JSON.stringify(config.extraParams || {}), [config.extraParams]);\n    (0, _react.useEffect)(() => {\n      let isMounted = true;\n      if (discovery) {\n        const request = new AuthRequestInstance(config);\n        request.makeAuthUrlAsync(discovery).then(() => {\n          if (isMounted) {\n            setRequest(request);\n          }\n        });\n      }\n      return () => {\n        isMounted = false;\n      };\n    }, [discovery?.authorizationEndpoint, config.clientId, config.redirectUri, config.responseType, config.prompt, config.clientSecret, config.codeChallenge, config.state, config.usePKCE, scopeString, extraParamsString]);\n    return request;\n  }\n  function useAuthRequestResult(request, discovery, customOptions = {}) {\n    const [result, setResult] = (0, _react.useState)(null);\n    const promptAsync = (0, _react.useCallback)(async ({\n      windowFeatures = {},\n      ...options\n    } = {}) => {\n      if (!discovery || !request) {\n        throw new Error('Cannot prompt to authenticate until the request has finished loading.');\n      }\n      const inputOptions = {\n        ...customOptions,\n        ...options,\n        windowFeatures: {\n          ...(customOptions.windowFeatures ?? {}),\n          ...windowFeatures\n        }\n      };\n      const result = await request?.promptAsync(discovery, inputOptions);\n      setResult(result);\n      return result;\n    }, [request?.url, discovery?.authorizationEndpoint]);\n    return [result, promptAsync];\n  }\n  // @needsAudit\n  /**\n   * Load an authorization request for a code. When the prompt method completes then the response will be fulfilled.\n   *\n   * > In order to close the popup window on web, you need to invoke `WebBrowser.maybeCompleteAuthSession()`.\n   * > See the [Identity example](/guides/authentication#identityserver-4) for more info.\n   *\n   * If an Implicit grant flow was used, you can pass the `response.params` to `TokenResponse.fromQueryParams()`\n   * to get a `TokenResponse` instance which you can use to easily refresh the token.\n   *\n   * @param config A valid [`AuthRequestConfig`](#authrequestconfig) that specifies what provider to use.\n   * @param discovery A loaded [`DiscoveryDocument`](#discoverydocument) with endpoints used for authenticating.\n   * Only `authorizationEndpoint` is required for requesting an authorization code.\n   *\n   * @return Returns a loaded request, a response, and a prompt method in a single array in the following order:\n   * - `request` - An instance of [`AuthRequest`](#authrequest) that can be used to prompt the user for authorization.\n   *   This will be `null` until the auth request has finished loading.\n   * - `response` - This is `null` until `promptAsync` has been invoked. Once fulfilled it will return information about the authorization.\n   * - `promptAsync` - When invoked, a web browser will open up and prompt the user for authentication.\n   *   Accepts an [`AuthRequestPromptOptions`](#authrequestpromptoptions) object with options about how the prompt will execute.\n   *\n   * @example\n   * ```ts\n   * const [request, response, promptAsync] = useAuthRequest({ ... }, { ... });\n   * ```\n   */\n  function useAuthRequest(config, discovery) {\n    const request = useLoadedAuthRequest(config, discovery, _AuthRequest.AuthRequest);\n    const [result, promptAsync] = useAuthRequestResult(request, discovery);\n    return [request, result, promptAsync];\n  }\n});","lineCount":114,"map":[[9,2,1,0],[9,6,1,0,"_react"],[9,12,1,0],[9,15,1,0,"require"],[9,22,1,0],[9,23,1,0,"_dependencyMap"],[9,37,1,0],[10,2,2,0],[10,6,2,0,"_AuthRequest"],[10,18,2,0],[10,21,2,0,"require"],[10,28,2,0],[10,29,2,0,"_dependencyMap"],[10,43,2,0],[11,2,3,0],[11,6,3,0,"_Discovery"],[11,16,3,0],[11,19,3,0,"require"],[11,26,3,0],[11,27,3,0,"_dependencyMap"],[11,41,3,0],[12,2,4,0],[13,2,5,0],[14,0,6,0],[15,0,7,0],[16,0,8,0],[17,0,9,0],[18,0,10,0],[19,0,11,0],[20,0,12,0],[21,0,13,0],[22,0,14,0],[23,0,15,0],[24,0,16,0],[25,2,17,7],[25,11,17,16,"useAutoDiscovery"],[25,27,17,32,"useAutoDiscovery"],[25,28,17,33,"issuerOrDiscovery"],[25,45,17,50],[25,47,17,52],[26,4,18,4],[26,10,18,10],[26,11,18,11,"discovery"],[26,20,18,20],[26,22,18,22,"setDiscovery"],[26,34,18,34],[26,35,18,35],[26,38,18,38],[26,42,18,38,"useState"],[26,57,18,46],[26,59,18,47],[26,63,18,51],[26,64,18,52],[27,4,19,4],[27,8,19,4,"useEffect"],[27,24,19,13],[27,26,19,14],[27,32,19,20],[28,6,20,8],[28,10,20,12,"isAllowed"],[28,19,20,21],[28,22,20,24],[28,26,20,28],[29,6,21,8],[29,10,21,8,"resolveDiscoveryAsync"],[29,42,21,29],[29,44,21,30,"issuerOrDiscovery"],[29,61,21,47],[29,62,21,48],[29,63,21,49,"then"],[29,67,21,53],[29,68,21,55,"discovery"],[29,77,21,64],[29,81,21,69],[30,8,22,12],[30,12,22,16,"isAllowed"],[30,21,22,25],[30,23,22,27],[31,10,23,16,"setDiscovery"],[31,22,23,28],[31,23,23,29,"discovery"],[31,32,23,38],[31,33,23,39],[32,8,24,12],[33,6,25,8],[33,7,25,9],[33,8,25,10],[34,6,26,8],[34,13,26,15],[34,19,26,21],[35,8,27,12,"isAllowed"],[35,17,27,21],[35,20,27,24],[35,25,27,29],[36,6,28,8],[36,7,28,9],[37,4,29,4],[37,5,29,5],[37,7,29,7],[37,8,29,8,"issuerOrDiscovery"],[37,25,29,25],[37,26,29,26],[37,27,29,27],[38,4,30,4],[38,11,30,11,"discovery"],[38,20,30,20],[39,2,31,0],[40,2,32,7],[40,11,32,16,"useLoadedAuthRequest"],[40,31,32,36,"useLoadedAuthRequest"],[40,32,32,37,"config"],[40,38,32,43],[40,40,32,45,"discovery"],[40,49,32,54],[40,51,32,56,"AuthRequestInstance"],[40,70,32,75],[40,72,32,77],[41,4,33,4],[41,10,33,10],[41,11,33,11,"request"],[41,18,33,18],[41,20,33,20,"setRequest"],[41,30,33,30],[41,31,33,31],[41,34,33,34],[41,38,33,34,"useState"],[41,53,33,42],[41,55,33,43],[41,59,33,47],[41,60,33,48],[42,4,34,4],[42,10,34,10,"scopeString"],[42,21,34,21],[42,24,34,24],[42,28,34,24,"useMemo"],[42,42,34,31],[42,44,34,32],[42,50,34,38,"config"],[42,56,34,44],[42,57,34,45,"scopes"],[42,63,34,51],[42,65,34,53,"join"],[42,69,34,57],[42,70,34,58],[42,73,34,61],[42,74,34,62],[42,76,34,64],[42,77,34,65,"config"],[42,83,34,71],[42,84,34,72,"scopes"],[42,90,34,78],[42,91,34,79],[42,92,34,80],[43,4,35,4],[43,10,35,10,"extraParamsString"],[43,27,35,27],[43,30,35,30],[43,34,35,30,"useMemo"],[43,48,35,37],[43,50,35,38],[43,56,35,44,"JSON"],[43,60,35,48],[43,61,35,49,"stringify"],[43,70,35,58],[43,71,35,59,"config"],[43,77,35,65],[43,78,35,66,"extraParams"],[43,89,35,77],[43,93,35,81],[43,94,35,82],[43,95,35,83],[43,96,35,84],[43,98,35,86],[43,99,35,87,"config"],[43,105,35,93],[43,106,35,94,"extraParams"],[43,117,35,105],[43,118,35,106],[43,119,35,107],[44,4,36,4],[44,8,36,4,"useEffect"],[44,24,36,13],[44,26,36,14],[44,32,36,20],[45,6,37,8],[45,10,37,12,"isMounted"],[45,19,37,21],[45,22,37,24],[45,26,37,28],[46,6,38,8],[46,10,38,12,"discovery"],[46,19,38,21],[46,21,38,23],[47,8,39,12],[47,14,39,18,"request"],[47,21,39,25],[47,24,39,28],[47,28,39,32,"AuthRequestInstance"],[47,47,39,51],[47,48,39,52,"config"],[47,54,39,58],[47,55,39,59],[48,8,40,12,"request"],[48,15,40,19],[48,16,40,20,"makeAuthUrlAsync"],[48,32,40,36],[48,33,40,37,"discovery"],[48,42,40,46],[48,43,40,47],[48,44,40,48,"then"],[48,48,40,52],[48,49,40,53],[48,55,40,59],[49,10,41,16],[49,14,41,20,"isMounted"],[49,23,41,29],[49,25,41,31],[50,12,42,20,"setRequest"],[50,22,42,30],[50,23,42,31,"request"],[50,30,42,38],[50,31,42,39],[51,10,43,16],[52,8,44,12],[52,9,44,13],[52,10,44,14],[53,6,45,8],[54,6,46,8],[54,13,46,15],[54,19,46,21],[55,8,47,12,"isMounted"],[55,17,47,21],[55,20,47,24],[55,25,47,29],[56,6,48,8],[56,7,48,9],[57,4,49,4],[57,5,49,5],[57,7,49,7],[57,8,50,8,"discovery"],[57,17,50,17],[57,19,50,19,"authorizationEndpoint"],[57,40,50,40],[57,42,51,8,"config"],[57,48,51,14],[57,49,51,15,"clientId"],[57,57,51,23],[57,59,52,8,"config"],[57,65,52,14],[57,66,52,15,"redirectUri"],[57,77,52,26],[57,79,53,8,"config"],[57,85,53,14],[57,86,53,15,"responseType"],[57,98,53,27],[57,100,54,8,"config"],[57,106,54,14],[57,107,54,15,"prompt"],[57,113,54,21],[57,115,55,8,"config"],[57,121,55,14],[57,122,55,15,"clientSecret"],[57,134,55,27],[57,136,56,8,"config"],[57,142,56,14],[57,143,56,15,"codeChallenge"],[57,156,56,28],[57,158,57,8,"config"],[57,164,57,14],[57,165,57,15,"state"],[57,170,57,20],[57,172,58,8,"config"],[57,178,58,14],[57,179,58,15,"usePKCE"],[57,186,58,22],[57,188,59,8,"scopeString"],[57,199,59,19],[57,201,60,8,"extraParamsString"],[57,218,60,25],[57,219,61,5],[57,220,61,6],[58,4,62,4],[58,11,62,11,"request"],[58,18,62,18],[59,2,63,0],[60,2,64,7],[60,11,64,16,"useAuthRequestResult"],[60,31,64,36,"useAuthRequestResult"],[60,32,64,37,"request"],[60,39,64,44],[60,41,64,46,"discovery"],[60,50,64,55],[60,52,64,57,"customOptions"],[60,65,64,70],[60,68,64,73],[60,69,64,74],[60,70,64,75],[60,72,64,77],[61,4,65,4],[61,10,65,10],[61,11,65,11,"result"],[61,17,65,17],[61,19,65,19,"setResult"],[61,28,65,28],[61,29,65,29],[61,32,65,32],[61,36,65,32,"useState"],[61,51,65,40],[61,53,65,41],[61,57,65,45],[61,58,65,46],[62,4,66,4],[62,10,66,10,"promptAsync"],[62,21,66,21],[62,24,66,24],[62,28,66,24,"useCallback"],[62,46,66,35],[62,48,66,36],[62,55,66,43],[63,6,66,45,"windowFeatures"],[63,20,66,59],[63,23,66,62],[63,24,66,63],[63,25,66,64],[64,6,66,66],[64,9,66,69,"options"],[65,4,66,77],[65,5,66,78],[65,8,66,81],[65,9,66,82],[65,10,66,83],[65,15,66,88],[66,6,67,8],[66,10,67,12],[66,11,67,13,"discovery"],[66,20,67,22],[66,24,67,26],[66,25,67,27,"request"],[66,32,67,34],[66,34,67,36],[67,8,68,12],[67,14,68,18],[67,18,68,22,"Error"],[67,23,68,27],[67,24,68,28],[67,95,68,99],[67,96,68,100],[68,6,69,8],[69,6,70,8],[69,12,70,14,"inputOptions"],[69,24,70,26],[69,27,70,29],[70,8,71,12],[70,11,71,15,"customOptions"],[70,24,71,28],[71,8,72,12],[71,11,72,15,"options"],[71,18,72,22],[72,8,73,12,"windowFeatures"],[72,22,73,26],[72,24,73,28],[73,10,74,16],[73,14,74,20,"customOptions"],[73,27,74,33],[73,28,74,34,"windowFeatures"],[73,42,74,48],[73,46,74,52],[73,47,74,53],[73,48,74,54],[73,49,74,55],[74,10,75,16],[74,13,75,19,"windowFeatures"],[75,8,76,12],[76,6,77,8],[76,7,77,9],[77,6,78,8],[77,12,78,14,"result"],[77,18,78,20],[77,21,78,23],[77,27,78,29,"request"],[77,34,78,36],[77,36,78,38,"promptAsync"],[77,47,78,49],[77,48,78,50,"discovery"],[77,57,78,59],[77,59,78,61,"inputOptions"],[77,71,78,73],[77,72,78,74],[78,6,79,8,"setResult"],[78,15,79,17],[78,16,79,18,"result"],[78,22,79,24],[78,23,79,25],[79,6,80,8],[79,13,80,15,"result"],[79,19,80,21],[80,4,81,4],[80,5,81,5],[80,7,81,7],[80,8,81,8,"request"],[80,15,81,15],[80,17,81,17,"url"],[80,20,81,20],[80,22,81,22,"discovery"],[80,31,81,31],[80,33,81,33,"authorizationEndpoint"],[80,54,81,54],[80,55,81,55],[80,56,81,56],[81,4,82,4],[81,11,82,11],[81,12,82,12,"result"],[81,18,82,18],[81,20,82,20,"promptAsync"],[81,31,82,31],[81,32,82,32],[82,2,83,0],[83,2,84,0],[84,2,85,0],[85,0,86,0],[86,0,87,0],[87,0,88,0],[88,0,89,0],[89,0,90,0],[90,0,91,0],[91,0,92,0],[92,0,93,0],[93,0,94,0],[94,0,95,0],[95,0,96,0],[96,0,97,0],[97,0,98,0],[98,0,99,0],[99,0,100,0],[100,0,101,0],[101,0,102,0],[102,0,103,0],[103,0,104,0],[104,0,105,0],[105,0,106,0],[106,0,107,0],[107,0,108,0],[108,0,109,0],[109,2,110,7],[109,11,110,16,"useAuthRequest"],[109,25,110,30,"useAuthRequest"],[109,26,110,31,"config"],[109,32,110,37],[109,34,110,39,"discovery"],[109,43,110,48],[109,45,110,50],[110,4,111,4],[110,10,111,10,"request"],[110,17,111,17],[110,20,111,20,"useLoadedAuthRequest"],[110,40,111,40],[110,41,111,41,"config"],[110,47,111,47],[110,49,111,49,"discovery"],[110,58,111,58],[110,60,111,60,"AuthRequest"],[110,84,111,71],[110,85,111,72],[111,4,112,4],[111,10,112,10],[111,11,112,11,"result"],[111,17,112,17],[111,19,112,19,"promptAsync"],[111,30,112,30],[111,31,112,31],[111,34,112,34,"useAuthRequestResult"],[111,54,112,54],[111,55,112,55,"request"],[111,62,112,62],[111,64,112,64,"discovery"],[111,73,112,73],[111,74,112,74],[112,4,113,4],[112,11,113,11],[112,12,113,12,"request"],[112,19,113,19],[112,21,113,21,"result"],[112,27,113,27],[112,29,113,29,"promptAsync"],[112,40,113,40],[112,41,113,41],[113,2,114,0],[114,0,114,1]],"functionMap":{"names":["<global>","useAutoDiscovery","useEffect$argument_0","resolveDiscoveryAsync.then$argument_0","<anonymous>","useLoadedAuthRequest","useMemo$argument_0","request.makeAuthUrlAsync.then$argument_0","useAuthRequestResult","promptAsync","useAuthRequest"],"mappings":"AAA;OCgB;cCE;sDCE;SDI;eEC;SFE;KDC;CDE;OKC;gCCE,8BD;sCCC,8CD;cHC;qDKI;aLI;eEE;SFE;KGC;CLc;OQC;oCCE;KDe;CRE;OU2B;CVI"}},"type":"js/module"}]}