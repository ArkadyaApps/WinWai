{"dependencies":[{"name":"./ExpoLocation","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":42,"index":42}}],"key":"n9eQB3huKj/lRnIsgaXRKPJKjaY=","exportNames":["*"],"imports":1}},{"name":"./LocationEventEmitter","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":43},"end":{"line":2,"column":62,"index":105}}],"key":"38XLRnQdDBx35ZID4eB8duhAnLg=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"LocationSubscriber\", {\n    enumerable: true,\n    get: function () {\n      return LocationSubscriber;\n    }\n  });\n  Object.defineProperty(exports, \"HeadingSubscriber\", {\n    enumerable: true,\n    get: function () {\n      return HeadingSubscriber;\n    }\n  });\n  exports._getCurrentWatchId = _getCurrentWatchId;\n  var _ExpoLocation = require(_dependencyMap[0], \"./ExpoLocation\");\n  var ExpoLocation = _interopDefault(_ExpoLocation);\n  var _LocationEventEmitter = require(_dependencyMap[1], \"./LocationEventEmitter\");\n  let nextWatchId = 0;\n  class Subscriber {\n    callbacks = {};\n    eventSubscription = null;\n    constructor(eventName, eventDataField) {\n      this.eventName = eventName;\n      this.eventDataField = eventDataField;\n    }\n    maybeInitializeSubscription() {\n      if (this.eventSubscription) {\n        return;\n      }\n      this.eventSubscription = _LocationEventEmitter.LocationEventEmitter.addListener(this.eventName, event => this.trigger(event));\n    }\n    /**\n     * Registers given callback under new id which is then returned.\n     */\n    registerCallback(callback) {\n      this.maybeInitializeSubscription();\n      const id = ++nextWatchId;\n      this.callbacks[id] = callback;\n      return id;\n    }\n    /**\n     * Unregisters a callback with given id and revokes the subscription if possible.\n     */\n    unregisterCallback(id) {\n      // Do nothing if we have already unregistered the callback.\n      if (!this.callbacks[id]) {\n        return;\n      }\n      delete this.callbacks[id];\n      ExpoLocation.default.removeWatchAsync(id);\n      if (Object.keys(this.callbacks).length === 0 && this.eventSubscription) {\n        _LocationEventEmitter.LocationEventEmitter.removeSubscription(this.eventSubscription);\n        this.eventSubscription = null;\n      }\n    }\n    trigger(event) {\n      const watchId = event.watchId;\n      const callback = this.callbacks[watchId];\n      if (callback) {\n        callback(event[this.eventDataField]);\n      } else {\n        ExpoLocation.default.removeWatchAsync(watchId);\n      }\n    }\n  }\n  const LocationSubscriber = new Subscriber('Expo.locationChanged', 'location');\n  const HeadingSubscriber = new Subscriber('Expo.headingChanged', 'heading');\n  /**\n   * @private Necessary for some unit tests.\n   */\n  function _getCurrentWatchId() {\n    return nextWatchId;\n  }\n});","lineCount":84,"map":[[12,2,54,0,"Object"],[12,8,54,0],[12,9,54,0,"defineProperty"],[12,23,54,0],[12,24,54,0,"exports"],[12,31,54,0],[13,4,54,0,"enumerable"],[13,14,54,0],[14,4,54,0,"get"],[14,7,54,0],[14,18,54,0,"get"],[14,19,54,0],[15,6,54,0],[15,13,54,0,"LocationSubscriber"],[15,31,54,0],[16,4,54,0],[17,2,54,0],[18,2,55,0,"Object"],[18,8,55,0],[18,9,55,0,"defineProperty"],[18,23,55,0],[18,24,55,0,"exports"],[18,31,55,0],[19,4,55,0,"enumerable"],[19,14,55,0],[20,4,55,0,"get"],[20,7,55,0],[20,18,55,0,"get"],[20,19,55,0],[21,6,55,0],[21,13,55,0,"HeadingSubscriber"],[21,30,55,0],[22,4,55,0],[23,2,55,0],[24,2,59,0,"exports"],[24,9,59,0],[24,10,59,0,"_getCurrentWatchId"],[24,28,59,0],[24,31,59,0,"_getCurrentWatchId"],[24,49,59,0],[25,2,1,0],[25,6,1,0,"_ExpoLocation"],[25,19,1,0],[25,22,1,0,"require"],[25,29,1,0],[25,30,1,0,"_dependencyMap"],[25,44,1,0],[26,2,1,0],[26,6,1,0,"ExpoLocation"],[26,18,1,0],[26,21,1,0,"_interopDefault"],[26,36,1,0],[26,37,1,0,"_ExpoLocation"],[26,50,1,0],[27,2,2,0],[27,6,2,0,"_LocationEventEmitter"],[27,27,2,0],[27,30,2,0,"require"],[27,37,2,0],[27,38,2,0,"_dependencyMap"],[27,52,2,0],[28,2,3,0],[28,6,3,4,"nextWatchId"],[28,17,3,15],[28,20,3,18],[28,21,3,19],[29,2,4,0],[29,8,4,6,"Subscriber"],[29,18,4,16],[29,19,4,17],[30,4,7,4,"callbacks"],[30,13,7,13],[30,16,7,16],[30,17,7,17],[30,18,7,18],[31,4,8,4,"eventSubscription"],[31,21,8,21],[31,24,8,24],[31,28,8,28],[32,4,9,4,"constructor"],[32,15,9,15,"constructor"],[32,16,9,16,"eventName"],[32,25,9,25],[32,27,9,27,"eventDataField"],[32,41,9,41],[32,43,9,43],[33,6,10,8],[33,10,10,12],[33,11,10,13,"eventName"],[33,20,10,22],[33,23,10,25,"eventName"],[33,32,10,34],[34,6,11,8],[34,10,11,12],[34,11,11,13,"eventDataField"],[34,25,11,27],[34,28,11,30,"eventDataField"],[34,42,11,44],[35,4,12,4],[36,4,13,4,"maybeInitializeSubscription"],[36,31,13,31,"maybeInitializeSubscription"],[36,32,13,31],[36,34,13,34],[37,6,14,8],[37,10,14,12],[37,14,14,16],[37,15,14,17,"eventSubscription"],[37,32,14,34],[37,34,14,36],[38,8,15,12],[39,6,16,8],[40,6,17,8],[40,10,17,12],[40,11,17,13,"eventSubscription"],[40,28,17,30],[40,31,17,33,"LocationEventEmitter"],[40,52,17,53],[40,53,17,53,"LocationEventEmitter"],[40,73,17,53],[40,74,17,54,"addListener"],[40,85,17,65],[40,86,17,66],[40,90,17,70],[40,91,17,71,"eventName"],[40,100,17,80],[40,102,17,83,"event"],[40,107,17,88],[40,111,17,93],[40,115,17,97],[40,116,17,98,"trigger"],[40,123,17,105],[40,124,17,106,"event"],[40,129,17,111],[40,130,17,112],[40,131,17,113],[41,4,18,4],[42,4,19,4],[43,0,20,0],[44,0,21,0],[45,4,22,4,"registerCallback"],[45,20,22,20,"registerCallback"],[45,21,22,21,"callback"],[45,29,22,29],[45,31,22,31],[46,6,23,8],[46,10,23,12],[46,11,23,13,"maybeInitializeSubscription"],[46,38,23,40],[46,39,23,41],[46,40,23,42],[47,6,24,8],[47,12,24,14,"id"],[47,14,24,16],[47,17,24,19],[47,19,24,21,"nextWatchId"],[47,30,24,32],[48,6,25,8],[48,10,25,12],[48,11,25,13,"callbacks"],[48,20,25,22],[48,21,25,23,"id"],[48,23,25,25],[48,24,25,26],[48,27,25,29,"callback"],[48,35,25,37],[49,6,26,8],[49,13,26,15,"id"],[49,15,26,17],[50,4,27,4],[51,4,28,4],[52,0,29,0],[53,0,30,0],[54,4,31,4,"unregisterCallback"],[54,22,31,22,"unregisterCallback"],[54,23,31,23,"id"],[54,25,31,25],[54,27,31,27],[55,6,32,8],[56,6,33,8],[56,10,33,12],[56,11,33,13],[56,15,33,17],[56,16,33,18,"callbacks"],[56,25,33,27],[56,26,33,28,"id"],[56,28,33,30],[56,29,33,31],[56,31,33,33],[57,8,34,12],[58,6,35,8],[59,6,36,8],[59,13,36,15],[59,17,36,19],[59,18,36,20,"callbacks"],[59,27,36,29],[59,28,36,30,"id"],[59,30,36,32],[59,31,36,33],[60,6,37,8,"ExpoLocation"],[60,18,37,20],[60,19,37,20,"default"],[60,26,37,20],[60,27,37,21,"removeWatchAsync"],[60,43,37,37],[60,44,37,38,"id"],[60,46,37,40],[60,47,37,41],[61,6,38,8],[61,10,38,12,"Object"],[61,16,38,18],[61,17,38,19,"keys"],[61,21,38,23],[61,22,38,24],[61,26,38,28],[61,27,38,29,"callbacks"],[61,36,38,38],[61,37,38,39],[61,38,38,40,"length"],[61,44,38,46],[61,49,38,51],[61,50,38,52],[61,54,38,56],[61,58,38,60],[61,59,38,61,"eventSubscription"],[61,76,38,78],[61,78,38,80],[62,8,39,12,"LocationEventEmitter"],[62,29,39,32],[62,30,39,32,"LocationEventEmitter"],[62,50,39,32],[62,51,39,33,"removeSubscription"],[62,69,39,51],[62,70,39,52],[62,74,39,56],[62,75,39,57,"eventSubscription"],[62,92,39,74],[62,93,39,75],[63,8,40,12],[63,12,40,16],[63,13,40,17,"eventSubscription"],[63,30,40,34],[63,33,40,37],[63,37,40,41],[64,6,41,8],[65,4,42,4],[66,4,43,4,"trigger"],[66,11,43,11,"trigger"],[66,12,43,12,"event"],[66,17,43,17],[66,19,43,19],[67,6,44,8],[67,12,44,14,"watchId"],[67,19,44,21],[67,22,44,24,"event"],[67,27,44,29],[67,28,44,30,"watchId"],[67,35,44,37],[68,6,45,8],[68,12,45,14,"callback"],[68,20,45,22],[68,23,45,25],[68,27,45,29],[68,28,45,30,"callbacks"],[68,37,45,39],[68,38,45,40,"watchId"],[68,45,45,47],[68,46,45,48],[69,6,46,8],[69,10,46,12,"callback"],[69,18,46,20],[69,20,46,22],[70,8,47,12,"callback"],[70,16,47,20],[70,17,47,21,"event"],[70,22,47,26],[70,23,47,27],[70,27,47,31],[70,28,47,32,"eventDataField"],[70,42,47,46],[70,43,47,47],[70,44,47,48],[71,6,48,8],[71,7,48,9],[71,13,49,13],[72,8,50,12,"ExpoLocation"],[72,20,50,24],[72,21,50,24,"default"],[72,28,50,24],[72,29,50,25,"removeWatchAsync"],[72,45,50,41],[72,46,50,42,"watchId"],[72,53,50,49],[72,54,50,50],[73,6,51,8],[74,4,52,4],[75,2,53,0],[76,2,54,7],[76,8,54,13,"LocationSubscriber"],[76,26,54,31],[76,29,54,34],[76,33,54,38,"Subscriber"],[76,43,54,48],[76,44,54,49],[76,66,54,71],[76,68,54,73],[76,78,54,83],[76,79,54,84],[77,2,55,7],[77,8,55,13,"HeadingSubscriber"],[77,25,55,30],[77,28,55,33],[77,32,55,37,"Subscriber"],[77,42,55,47],[77,43,55,48],[77,64,55,69],[77,66,55,71],[77,75,55,80],[77,76,55,81],[78,2,56,0],[79,0,57,0],[80,0,58,0],[81,2,59,7],[81,11,59,16,"_getCurrentWatchId"],[81,29,59,34,"_getCurrentWatchId"],[81,30,59,34],[81,32,59,37],[82,4,60,4],[82,11,60,11,"nextWatchId"],[82,22,60,22],[83,2,61,0],[84,0,61,1],[84,3]],"functionMap":{"names":["<global>","Subscriber","Subscriber#constructor","Subscriber#maybeInitializeSubscription","LocationEventEmitter.addListener$argument_1","Subscriber#registerCallback","Subscriber#unregisterCallback","Subscriber#trigger","_getCurrentWatchId"],"mappings":"AAA;ACG;ICK;KDG;IEC;kFCI,8BD;KFC;III;KJK;IKI;KLW;IMC;KNS;CDC;OQM;CRE"},"hasCjsExports":false},"type":"js/module"}]}