{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"asyncType":null,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":153,"column":0,"index":4127}}],"key":"7kvm5yrOpz4NYiDi6sn4qxa8DVQ="}},{"name":"../../Network/RCTNetworking","data":{"asyncType":null,"locs":[{"start":{"line":12,"column":0,"index":252},"end":{"line":12,"column":53,"index":305}}],"key":"wySpsWJSjIQ5Ial9e44CE8RyR7A="}},{"name":"../../Utilities/HMRClient","data":{"asyncType":null,"locs":[{"start":{"line":13,"column":0,"index":306},"end":{"line":13,"column":50,"index":356}}],"key":"LgBf4jLtCmwaRryTgQUTgtwHEdY="}},{"name":"../../Utilities/LoadingView","data":{"asyncType":null,"locs":[{"start":{"line":14,"column":0,"index":357},"end":{"line":14,"column":54,"index":411}}],"key":"QCTlb0sf5YP2JQBXVB7mpu2/aQE="}},{"name":"./getDevServer","data":{"asyncType":null,"locs":[{"start":{"line":15,"column":0,"index":412},"end":{"line":15,"column":42,"index":454}}],"key":"PEcM6TbyS4rBYfu5y89u4bAVQj8="}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = require(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n  var _RCTNetworking = _interopRequireDefault(require(_dependencyMap[1], \"../../Network/RCTNetworking\"));\n  var _HMRClient = _interopRequireDefault(require(_dependencyMap[2], \"../../Utilities/HMRClient\"));\n  var _LoadingView = _interopRequireDefault(require(_dependencyMap[3], \"../../Utilities/LoadingView\"));\n  var _getDevServer = _interopRequireDefault(require(_dependencyMap[4], \"./getDevServer\"));\n  /**\n   * Copyright (c) Meta Platforms, Inc. and affiliates.\n   *\n   * This source code is licensed under the MIT license found in the\n   * LICENSE file in the root directory of this source tree.\n   *\n   * \n   * @format\n   * @oncall react_native\n   */\n\n  let pendingRequests = 0;\n  const cachedPromisesByUrl = new Map();\n  function asyncRequest(url) {\n    let id = null;\n    let responseText = null;\n    let headers = null;\n    let dataListener;\n    let completeListener;\n    let responseListener;\n    let incrementalDataListener;\n    return new Promise((resolve, reject) => {\n      dataListener = _RCTNetworking.default.addListener('didReceiveNetworkData', ([requestId, response]) => {\n        if (requestId === id) {\n          responseText = response;\n        }\n      });\n      incrementalDataListener = _RCTNetworking.default.addListener('didReceiveNetworkIncrementalData', ([requestId, data]) => {\n        if (requestId === id) {\n          if (responseText != null) {\n            responseText += data;\n          } else {\n            responseText = data;\n          }\n        }\n      });\n      responseListener = _RCTNetworking.default.addListener('didReceiveNetworkResponse', ([requestId, status, responseHeaders]) => {\n        if (requestId === id) {\n          headers = responseHeaders;\n        }\n      });\n      completeListener = _RCTNetworking.default.addListener('didCompleteNetworkResponse', ([requestId, error]) => {\n        if (requestId === id) {\n          if (error) {\n            reject(error);\n          } else {\n            //$FlowFixMe[incompatible-call]\n            resolve({\n              body: responseText,\n              headers\n            });\n          }\n        }\n      });\n      _RCTNetworking.default.sendRequest('GET', 'asyncRequest', url, {}, '', 'text', true, 0, requestId => {\n        id = requestId;\n      }, true);\n    }).finally(() => {\n      dataListener?.remove();\n      completeListener?.remove();\n      responseListener?.remove();\n      incrementalDataListener?.remove();\n    });\n  }\n  function buildUrlForBundle(bundlePathAndQuery) {\n    const {\n      url: serverUrl\n    } = (0, _getDevServer.default)();\n    return serverUrl.replace(/\\/+$/, '') + '/' + bundlePathAndQuery.replace(/^\\/+/, '');\n  }\n  module.exports = function (bundlePathAndQuery) {\n    const requestUrl = buildUrlForBundle(bundlePathAndQuery);\n    let loadPromise = cachedPromisesByUrl.get(requestUrl);\n    if (loadPromise) {\n      return loadPromise;\n    }\n    _LoadingView.default.showMessage('Downloading...', 'load');\n    ++pendingRequests;\n    loadPromise = asyncRequest(requestUrl).then(({\n      body,\n      headers\n    }) => {\n      if (headers['Content-Type'] != null && headers['Content-Type'].indexOf('application/json') >= 0) {\n        // Errors are returned as JSON.\n        throw new Error(JSON.parse(body).message || `Unknown error fetching '${bundlePathAndQuery}'`);\n      }\n      _HMRClient.default.registerBundle(requestUrl);\n\n      // Some engines do not support `sourceURL` as a comment. We expose a\n      // `globalEvalWithSourceUrl` function to handle updates in that case.\n      if (global.globalEvalWithSourceUrl) {\n        global.globalEvalWithSourceUrl(body, requestUrl);\n      } else {\n        // eslint-disable-next-line no-eval\n        eval(body);\n      }\n    }).catch(e => {\n      cachedPromisesByUrl.delete(requestUrl);\n      throw e;\n    }).finally(() => {\n      if (! --pendingRequests) {\n        _LoadingView.default.hide();\n      }\n    });\n    cachedPromisesByUrl.set(requestUrl, loadPromise);\n    return loadPromise;\n  };\n});","lineCount":114,"map":[[3,2,12,0],[3,6,12,0,"_RCTNetworking"],[3,20,12,0],[3,23,12,0,"_interopRequireDefault"],[3,45,12,0],[3,46,12,0,"require"],[3,53,12,0],[3,54,12,0,"_dependencyMap"],[3,68,12,0],[4,2,13,0],[4,6,13,0,"_HMRClient"],[4,16,13,0],[4,19,13,0,"_interopRequireDefault"],[4,41,13,0],[4,42,13,0,"require"],[4,49,13,0],[4,50,13,0,"_dependencyMap"],[4,64,13,0],[5,2,14,0],[5,6,14,0,"_LoadingView"],[5,18,14,0],[5,21,14,0,"_interopRequireDefault"],[5,43,14,0],[5,44,14,0,"require"],[5,51,14,0],[5,52,14,0,"_dependencyMap"],[5,66,14,0],[6,2,15,0],[6,6,15,0,"_getDevServer"],[6,19,15,0],[6,22,15,0,"_interopRequireDefault"],[6,44,15,0],[6,45,15,0,"require"],[6,52,15,0],[6,53,15,0,"_dependencyMap"],[6,67,15,0],[7,2,1,0],[8,0,2,0],[9,0,3,0],[10,0,4,0],[11,0,5,0],[12,0,6,0],[13,0,7,0],[14,0,8,0],[15,0,9,0],[16,0,10,0],[18,2,19,0],[18,6,19,4,"pendingRequests"],[18,21,19,19],[18,24,19,22],[18,25,19,23],[19,2,21,0],[19,8,21,6,"cachedPromisesByUrl"],[19,27,21,25],[19,30,21,28],[19,34,21,32,"Map"],[19,37,21,35],[19,38,21,59],[19,39,21,60],[20,2,23,0],[20,11,23,9,"asyncRequest"],[20,23,23,21,"asyncRequest"],[20,24,24,2,"url"],[20,27,24,13],[20,29,25,56],[21,4,26,2],[21,8,26,6,"id"],[21,10,26,8],[21,13,26,11],[21,17,26,15],[22,4,27,2],[22,8,27,6,"responseText"],[22,20,27,18],[22,23,27,21],[22,27,27,25],[23,4,28,2],[23,8,28,6,"headers"],[23,15,28,13],[23,18,28,16],[23,22,28,20],[24,4,29,2],[24,8,29,6,"dataListener"],[24,20,29,18],[25,4,30,2],[25,8,30,6,"completeListener"],[25,24,30,22],[26,4,31,2],[26,8,31,6,"responseListener"],[26,24,31,22],[27,4,32,2],[27,8,32,6,"incrementalDataListener"],[27,31,32,29],[28,4,33,2],[28,11,33,9],[28,15,33,13,"Promise"],[28,22,33,20],[28,23,34,4],[28,24,34,5,"resolve"],[28,31,34,12],[28,33,34,14,"reject"],[28,39,34,20],[28,44,34,25],[29,6,35,6,"dataListener"],[29,18,35,18],[29,21,35,21,"Networking"],[29,43,35,31],[29,44,35,32,"addListener"],[29,55,35,43],[29,56,36,8],[29,79,36,31],[29,81,37,8],[29,82,37,9],[29,83,37,10,"requestId"],[29,92,37,19],[29,94,37,21,"response"],[29,102,37,29],[29,103,37,30],[29,108,37,35],[30,8,38,10],[30,12,38,14,"requestId"],[30,21,38,23],[30,26,38,28,"id"],[30,28,38,30],[30,30,38,32],[31,10,39,12,"responseText"],[31,22,39,24],[31,25,39,27,"response"],[31,33,39,35],[32,8,40,10],[33,6,41,8],[33,7,42,6],[33,8,42,7],[34,6,43,6,"incrementalDataListener"],[34,29,43,29],[34,32,43,32,"Networking"],[34,54,43,42],[34,55,43,43,"addListener"],[34,66,43,54],[34,67,44,8],[34,101,44,42],[34,103,45,8],[34,104,45,9],[34,105,45,10,"requestId"],[34,114,45,19],[34,116,45,21,"data"],[34,120,45,25],[34,121,45,26],[34,126,45,31],[35,8,46,10],[35,12,46,14,"requestId"],[35,21,46,23],[35,26,46,28,"id"],[35,28,46,30],[35,30,46,32],[36,10,47,12],[36,14,47,16,"responseText"],[36,26,47,28],[36,30,47,32],[36,34,47,36],[36,36,47,38],[37,12,48,14,"responseText"],[37,24,48,26],[37,28,48,30,"data"],[37,32,48,34],[38,10,49,12],[38,11,49,13],[38,17,49,19],[39,12,50,14,"responseText"],[39,24,50,26],[39,27,50,29,"data"],[39,31,50,33],[40,10,51,12],[41,8,52,10],[42,6,53,8],[42,7,54,6],[42,8,54,7],[43,6,55,6,"responseListener"],[43,22,55,22],[43,25,55,25,"Networking"],[43,47,55,35],[43,48,55,36,"addListener"],[43,59,55,47],[43,60,56,8],[43,87,56,35],[43,89,57,8],[43,90,57,9],[43,91,57,10,"requestId"],[43,100,57,19],[43,102,57,21,"status"],[43,108,57,27],[43,110,57,29,"responseHeaders"],[43,125,57,44],[43,126,57,45],[43,131,57,50],[44,8,58,10],[44,12,58,14,"requestId"],[44,21,58,23],[44,26,58,28,"id"],[44,28,58,30],[44,30,58,32],[45,10,59,12,"headers"],[45,17,59,19],[45,20,59,22,"responseHeaders"],[45,35,59,37],[46,8,60,10],[47,6,61,8],[47,7,62,6],[47,8,62,7],[48,6,63,6,"completeListener"],[48,22,63,22],[48,25,63,25,"Networking"],[48,47,63,35],[48,48,63,36,"addListener"],[48,59,63,47],[48,60,64,8],[48,88,64,36],[48,90,65,8],[48,91,65,9],[48,92,65,10,"requestId"],[48,101,65,19],[48,103,65,21,"error"],[48,108,65,26],[48,109,65,27],[48,114,65,32],[49,8,66,10],[49,12,66,14,"requestId"],[49,21,66,23],[49,26,66,28,"id"],[49,28,66,30],[49,30,66,32],[50,10,67,12],[50,14,67,16,"error"],[50,19,67,21],[50,21,67,23],[51,12,68,14,"reject"],[51,18,68,20],[51,19,68,21,"error"],[51,24,68,26],[51,25,68,27],[52,10,69,12],[52,11,69,13],[52,17,69,19],[53,12,70,14],[54,12,71,14,"resolve"],[54,19,71,21],[54,20,71,22],[55,14,71,23,"body"],[55,18,71,27],[55,20,71,29,"responseText"],[55,32,71,41],[56,14,71,43,"headers"],[57,12,71,50],[57,13,71,51],[57,14,71,52],[58,10,72,12],[59,8,73,10],[60,6,74,8],[60,7,75,6],[60,8,75,7],[61,6,76,6,"Networking"],[61,28,76,16],[61,29,76,17,"sendRequest"],[61,40,76,28],[61,41,77,8],[61,46,77,13],[61,48,78,8],[61,62,78,22],[61,64,79,8,"url"],[61,67,79,11],[61,69,80,8],[61,70,80,9],[61,71,80,10],[61,73,81,8],[61,75,81,10],[61,77,82,8],[61,83,82,14],[61,85,83,8],[61,89,83,12],[61,91,84,8],[61,92,84,9],[61,94,85,8,"requestId"],[61,103,85,17],[61,107,85,21],[62,8,86,10,"id"],[62,10,86,12],[62,13,86,15,"requestId"],[62,22,86,24],[63,6,87,8],[63,7,87,9],[63,9,88,8],[63,13,89,6],[63,14,89,7],[64,4,90,4],[64,5,91,2],[64,6,91,3],[64,7,91,4,"finally"],[64,14,91,11],[64,15,91,12],[64,21,91,18],[65,6,92,4,"dataListener"],[65,18,92,16],[65,20,92,18,"remove"],[65,26,92,24],[65,27,92,25],[65,28,92,26],[66,6,93,4,"completeListener"],[66,22,93,20],[66,24,93,22,"remove"],[66,30,93,28],[66,31,93,29],[66,32,93,30],[67,6,94,4,"responseListener"],[67,22,94,20],[67,24,94,22,"remove"],[67,30,94,28],[67,31,94,29],[67,32,94,30],[68,6,95,4,"incrementalDataListener"],[68,29,95,27],[68,31,95,29,"remove"],[68,37,95,35],[68,38,95,36],[68,39,95,37],[69,4,96,2],[69,5,96,3],[69,6,96,4],[70,2,97,0],[71,2,99,0],[71,11,99,9,"buildUrlForBundle"],[71,28,99,26,"buildUrlForBundle"],[71,29,99,27,"bundlePathAndQuery"],[71,47,99,53],[71,49,99,55],[72,4,100,2],[72,10,100,8],[73,6,100,9,"url"],[73,9,100,12],[73,11,100,14,"serverUrl"],[74,4,100,23],[74,5,100,24],[74,8,100,27],[74,12,100,27,"getDevServer"],[74,33,100,39],[74,35,100,40],[74,36,100,41],[75,4,101,2],[75,11,102,4,"serverUrl"],[75,20,102,13],[75,21,102,14,"replace"],[75,28,102,21],[75,29,102,22],[75,35,102,28],[75,37,102,30],[75,39,102,32],[75,40,102,33],[75,43,102,36],[75,46,102,39],[75,49,102,42,"bundlePathAndQuery"],[75,67,102,60],[75,68,102,61,"replace"],[75,75,102,68],[75,76,102,69],[75,82,102,75],[75,84,102,77],[75,86,102,79],[75,87,102,80],[76,2,104,0],[77,2,106,0,"module"],[77,8,106,6],[77,9,106,7,"exports"],[77,16,106,14],[77,19,106,17],[77,29,106,27,"bundlePathAndQuery"],[77,47,106,53],[77,49,106,70],[78,4,107,2],[78,10,107,8,"requestUrl"],[78,20,107,18],[78,23,107,21,"buildUrlForBundle"],[78,40,107,38],[78,41,107,39,"bundlePathAndQuery"],[78,59,107,57],[78,60,107,58],[79,4,108,2],[79,8,108,6,"loadPromise"],[79,19,108,17],[79,22,108,20,"cachedPromisesByUrl"],[79,41,108,39],[79,42,108,40,"get"],[79,45,108,43],[79,46,108,44,"requestUrl"],[79,56,108,54],[79,57,108,55],[80,4,110,2],[80,8,110,6,"loadPromise"],[80,19,110,17],[80,21,110,19],[81,6,111,4],[81,13,111,11,"loadPromise"],[81,24,111,22],[82,4,112,2],[83,4,113,2,"LoadingView"],[83,24,113,13],[83,25,113,14,"showMessage"],[83,36,113,25],[83,37,113,26],[83,53,113,42],[83,55,113,44],[83,61,113,50],[83,62,113,51],[84,4,114,2],[84,6,114,4,"pendingRequests"],[84,21,114,19],[85,4,116,2,"loadPromise"],[85,15,116,13],[85,18,116,16,"asyncRequest"],[85,30,116,28],[85,31,116,29,"requestUrl"],[85,41,116,39],[85,42,116,40],[85,43,117,5,"then"],[85,47,117,9],[85,48,117,16],[85,49,117,17],[86,6,117,18,"body"],[86,10,117,22],[87,6,117,24,"headers"],[88,4,117,31],[88,5,117,32],[88,10,117,37],[89,6,118,6],[89,10,119,8,"headers"],[89,17,119,15],[89,18,119,16],[89,32,119,30],[89,33,119,31],[89,37,119,35],[89,41,119,39],[89,45,120,8,"headers"],[89,52,120,15],[89,53,120,16],[89,67,120,30],[89,68,120,31],[89,69,120,32,"indexOf"],[89,76,120,39],[89,77,120,40],[89,95,120,58],[89,96,120,59],[89,100,120,63],[89,101,120,64],[89,103,121,8],[90,8,122,8],[91,8,123,8],[91,14,123,14],[91,18,123,18,"Error"],[91,23,123,23],[91,24,124,10,"JSON"],[91,28,124,14],[91,29,124,15,"parse"],[91,34,124,20],[91,35,124,21,"body"],[91,39,124,25],[91,40,124,26],[91,41,124,27,"message"],[91,48,124,34],[91,52,125,12],[91,79,125,39,"bundlePathAndQuery"],[91,97,125,57],[91,100,126,8],[91,101,126,9],[92,6,127,6],[93,6,129,6,"HMRClient"],[93,24,129,15],[93,25,129,16,"registerBundle"],[93,39,129,30],[93,40,129,31,"requestUrl"],[93,50,129,41],[93,51,129,42],[95,6,131,6],[96,6,132,6],[97,6,133,6],[97,10,133,10,"global"],[97,16,133,16],[97,17,133,17,"globalEvalWithSourceUrl"],[97,40,133,40],[97,42,133,42],[98,8,134,8,"global"],[98,14,134,14],[98,15,134,15,"globalEvalWithSourceUrl"],[98,38,134,38],[98,39,134,39,"body"],[98,43,134,43],[98,45,134,45,"requestUrl"],[98,55,134,55],[98,56,134,56],[99,6,135,6],[99,7,135,7],[99,13,135,13],[100,8,136,8],[101,8,137,8,"eval"],[101,12,137,12],[101,13,137,13,"body"],[101,17,137,17],[101,18,137,18],[102,6,138,6],[103,4,139,4],[103,5,139,5],[103,6,139,6],[103,7,140,5,"catch"],[103,12,140,10],[103,13,140,17,"e"],[103,14,140,18],[103,18,140,22],[104,6,141,6,"cachedPromisesByUrl"],[104,25,141,25],[104,26,141,26,"delete"],[104,32,141,32],[104,33,141,33,"requestUrl"],[104,43,141,43],[104,44,141,44],[105,6,142,6],[105,12,142,12,"e"],[105,13,142,13],[106,4,143,4],[106,5,143,5],[106,6,143,6],[106,7,144,5,"finally"],[106,14,144,12],[106,15,144,13],[106,21,144,19],[107,6,145,6],[107,10,145,10],[107,11,145,11],[107,14,145,13,"pendingRequests"],[107,29,145,28],[107,31,145,30],[108,8,146,8,"LoadingView"],[108,28,146,19],[108,29,146,20,"hide"],[108,33,146,24],[108,34,146,25],[108,35,146,26],[109,6,147,6],[110,4,148,4],[110,5,148,5],[110,6,148,6],[111,4,150,2,"cachedPromisesByUrl"],[111,23,150,21],[111,24,150,22,"set"],[111,27,150,25],[111,28,150,26,"requestUrl"],[111,38,150,36],[111,40,150,38,"loadPromise"],[111,51,150,49],[111,52,150,50],[112,4,151,2],[112,11,151,9,"loadPromise"],[112,22,151,20],[113,2,152,0],[113,3,152,1],[114,0,152,2]],"functionMap":{"names":["<global>","asyncRequest","Promise$argument_0","Networking.addListener$argument_1","Networking.sendRequest$argument_8","Promise._finally$argument_0","buildUrlForBundle","module.exports","asyncRequest.then$argument_0","asyncRequest.then._catch$argument_0","asyncRequest.then._catch._finally$argument_0"],"mappings":"AAA;ACsB;ICW;QCG;SDI;QCI;SDQ;QCI;SDI;QCI;SDS;QEW;SFE;KDG;YIC;GJK;CDC;AME;CNK;iBOE;gBCW;KDsB;iBEC;KFG;aGC;KHI;CPI"}},"type":"js/module"}]}