{"dependencies":[{"name":"expo/virtual/env","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dgHc21cgR+buKc7O3/dChhD5JJk=","exportNames":["*"],"imports":1}},{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":89,"index":89}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":90},"end":{"line":2,"column":69,"index":159}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"expo-web-browser","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":160},"end":{"line":3,"column":47,"index":207}}],"key":"qFWzf28Sq0474idIhFBHQFboHaY=","exportNames":["*"],"imports":1}},{"name":"../store/userStore","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":208},"end":{"line":4,"column":50,"index":258}}],"key":"IgQi61grymUjzhOUT2rUJCaLs54=","exportNames":["*"],"imports":1}},{"name":"../utils/api","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":259},"end":{"line":5,"column":31,"index":290}}],"key":"XoJ+jbKCrEi38eKczMqtlbk+TCk=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/src/contexts/AuthContext.tsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  Object.defineProperty(exports, \"AuthProvider\", {\n    enumerable: true,\n    get: function () {\n      return AuthProvider;\n    }\n  });\n  Object.defineProperty(exports, \"useAuth\", {\n    enumerable: true,\n    get: function () {\n      return useAuth;\n    }\n  });\n  var _expoVirtualEnv = require(_dependencyMap[0], \"expo/virtual/env\");\n  var _react = require(_dependencyMap[1], \"react\");\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[2], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _expoWebBrowser = require(_dependencyMap[3], \"expo-web-browser\");\n  var WebBrowser = _interopNamespace(_expoWebBrowser);\n  var _storeUserStore = require(_dependencyMap[4], \"../store/userStore\");\n  var _utilsApi = require(_dependencyMap[5], \"../utils/api\");\n  var api = _interopDefault(_utilsApi);\n  var _reactJsxDevRuntime = require(_dependencyMap[6], \"react/jsx-dev-runtime\");\n  WebBrowser.maybeCompleteAuthSession();\n  const AuthContext = /*#__PURE__*/(0, _react.createContext)(undefined);\n  const AuthProvider = ({\n    children\n  }) => {\n    _s();\n    const {\n      setUser,\n      setLoading,\n      logout,\n      isLoading\n    } = (0, _storeUserStore.useUserStore)();\n    const [sessionId, setSessionId] = (0, _react.useState)(null);\n    (0, _react.useEffect)(() => {\n      checkExistingSession();\n    }, []);\n    const checkExistingSession = async () => {\n      try {\n        const token = await AsyncStorage.default.getItem('session_token');\n        if (token) {\n          const response = await api.default.get('/api/auth/me');\n          setUser(response.data);\n        } else {\n          setLoading(false);\n        }\n      } catch (error) {\n        console.error('Session check failed:', error);\n        await AsyncStorage.default.removeItem('session_token');\n        setLoading(false);\n      }\n    };\n    const signIn = async () => {\n      const redirectUrl = _expoVirtualEnv.env.EXPO_PUBLIC_REDIRECT_URL || 'https://winwai-fix-1.preview.emergentagent.com';\n      const authUrl = `https://auth.emergentagent.com/?redirect=${encodeURIComponent(redirectUrl)}`;\n      try {\n        const result = await WebBrowser.openAuthSessionAsync(authUrl, redirectUrl);\n        if (result.type === 'success' && result.url) {\n          const url = new URL(result.url);\n          const hash = url.hash.substring(1);\n          const params = new URLSearchParams(hash);\n          const sid = params.get('session_id');\n          if (sid) {\n            const response = await api.default.post('/api/auth/session', {\n              session_id: sid\n            });\n            const {\n              session_token,\n              user\n            } = response.data;\n            await AsyncStorage.default.setItem('session_token', session_token);\n            setUser(user);\n          }\n        }\n      } catch (error) {\n        console.error('Sign in failed:', error);\n        throw error;\n      }\n    };\n    const signOut = async () => {\n      try {\n        await api.default.post('/api/auth/logout');\n        await AsyncStorage.default.removeItem('session_token');\n        logout();\n      } catch (error) {\n        console.error('Sign out failed:', error);\n      }\n    };\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(AuthContext.Provider, {\n      value: {\n        signIn,\n        signOut,\n        isLoading\n      },\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 5\n    }, this);\n  };\n  _s(AuthProvider, \"tyUP7gYx00Tp5ERuwaT0q49JUHI=\", false, function () {\n    return [_storeUserStore.useUserStore];\n  });\n  _c = AuthProvider;\n  const useAuth = () => {\n    _s2();\n    const context = (0, _react.useContext)(AuthContext);\n    if (!context) {\n      throw new Error('useAuth must be used within AuthProvider');\n    }\n    return context;\n  };\n  _s2(useAuth, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\n  var _c;\n  $RefreshReg$(_c, \"AuthProvider\");\n});","lineCount":147,"map":[[30,2,17,0,"Object"],[30,8,17,0],[30,9,17,0,"defineProperty"],[30,23,17,0],[30,24,17,0,"exports"],[30,31,17,0],[31,4,17,0,"enumerable"],[31,14,17,0],[32,4,17,0,"get"],[32,7,17,0],[32,18,17,0,"get"],[32,19,17,0],[33,6,17,0],[33,13,17,0,"AuthProvider"],[33,25,17,0],[34,4,17,0],[35,2,17,0],[36,2,85,0,"Object"],[36,8,85,0],[36,9,85,0,"defineProperty"],[36,23,85,0],[36,24,85,0,"exports"],[36,31,85,0],[37,4,85,0,"enumerable"],[37,14,85,0],[38,4,85,0,"get"],[38,7,85,0],[38,18,85,0,"get"],[38,19,85,0],[39,6,85,0],[39,13,85,0,"useAuth"],[39,20,85,0],[40,4,85,0],[41,2,85,0],[42,2,91,2],[42,6,91,2,"_expoVirtualEnv"],[42,21,91,2],[42,24,91,2,"require"],[42,31,91,2],[42,32,91,2,"_dependencyMap"],[42,46,91,2],[43,2,1,0],[43,6,1,0,"_react"],[43,12,1,0],[43,15,1,0,"require"],[43,22,1,0],[43,23,1,0,"_dependencyMap"],[43,37,1,0],[44,2,2,0],[44,6,2,0,"_reactNativeAsyncStorageAsyncStorage"],[44,42,2,0],[44,45,2,0,"require"],[44,52,2,0],[44,53,2,0,"_dependencyMap"],[44,67,2,0],[45,2,2,0],[45,6,2,0,"AsyncStorage"],[45,18,2,0],[45,21,2,0,"_interopDefault"],[45,36,2,0],[45,37,2,0,"_reactNativeAsyncStorageAsyncStorage"],[45,73,2,0],[46,2,3,0],[46,6,3,0,"_expoWebBrowser"],[46,21,3,0],[46,24,3,0,"require"],[46,31,3,0],[46,32,3,0,"_dependencyMap"],[46,46,3,0],[47,2,3,0],[47,6,3,0,"WebBrowser"],[47,16,3,0],[47,19,3,0,"_interopNamespace"],[47,36,3,0],[47,37,3,0,"_expoWebBrowser"],[47,52,3,0],[48,2,4,0],[48,6,4,0,"_storeUserStore"],[48,21,4,0],[48,24,4,0,"require"],[48,31,4,0],[48,32,4,0,"_dependencyMap"],[48,46,4,0],[49,2,5,0],[49,6,5,0,"_utilsApi"],[49,15,5,0],[49,18,5,0,"require"],[49,25,5,0],[49,26,5,0,"_dependencyMap"],[49,40,5,0],[50,2,5,0],[50,6,5,0,"api"],[50,9,5,0],[50,12,5,0,"_interopDefault"],[50,27,5,0],[50,28,5,0,"_utilsApi"],[50,37,5,0],[51,2,5,31],[51,6,5,31,"_reactJsxDevRuntime"],[51,25,5,31],[51,28,5,31,"require"],[51,35,5,31],[51,36,5,31,"_dependencyMap"],[51,50,5,31],[52,2,7,0,"WebBrowser"],[52,12,7,10],[52,13,7,11,"maybeCompleteAuthSession"],[52,37,7,35],[52,38,7,36],[52,39,7,37],[53,2,15,0],[53,8,15,6,"AuthContext"],[53,19,15,17],[53,35,15,20],[53,39,15,20,"createContext"],[53,45,15,33],[53,46,15,33,"createContext"],[53,59,15,33],[53,61,15,63,"undefined"],[53,70,15,72],[53,71,15,73],[54,2,17,7],[54,8,17,13,"AuthProvider"],[54,20,17,25],[54,23,17,28,"AuthProvider"],[54,24,17,29],[55,4,17,31,"children"],[56,2,17,65],[56,3,17,66],[56,8,17,71],[57,4,17,71,"_s"],[57,6,17,71],[58,4,18,2],[58,10,18,8],[59,6,18,10,"setUser"],[59,13,18,17],[60,6,18,19,"setLoading"],[60,16,18,29],[61,6,18,31,"logout"],[61,12,18,37],[62,6,18,39,"isLoading"],[63,4,18,49],[63,5,18,50],[63,8,18,53],[63,12,18,53,"useUserStore"],[63,27,18,65],[63,28,18,65,"useUserStore"],[63,40,18,65],[63,42,18,66],[63,43,18,67],[64,4,19,2],[64,10,19,8],[64,11,19,9,"sessionId"],[64,20,19,18],[64,22,19,20,"setSessionId"],[64,34,19,32],[64,35,19,33],[64,38,19,36],[64,42,19,36,"useState"],[64,48,19,44],[64,49,19,44,"useState"],[64,57,19,44],[64,59,19,60],[64,63,19,64],[64,64,19,65],[65,4,21,2],[65,8,21,2,"useEffect"],[65,14,21,11],[65,15,21,11,"useEffect"],[65,24,21,11],[65,26,21,12],[65,32,21,18],[66,6,22,4,"checkExistingSession"],[66,26,22,24],[66,27,22,25],[66,28,22,26],[67,4,23,2],[67,5,23,3],[67,7,23,5],[67,9,23,7],[67,10,23,8],[68,4,25,2],[68,10,25,8,"checkExistingSession"],[68,30,25,28],[68,33,25,31],[68,39,25,31,"checkExistingSession"],[68,40,25,31],[68,45,25,43],[69,6,26,4],[69,10,26,8],[70,8,27,6],[70,14,27,12,"token"],[70,19,27,17],[70,22,27,20],[70,28,27,26,"AsyncStorage"],[70,40,27,38],[70,41,27,38,"default"],[70,48,27,38],[70,49,27,39,"getItem"],[70,56,27,46],[70,57,27,47],[70,72,27,62],[70,73,27,63],[71,8,28,6],[71,12,28,10,"token"],[71,17,28,15],[71,19,28,17],[72,10,29,8],[72,16,29,14,"response"],[72,24,29,22],[72,27,29,25],[72,33,29,31,"api"],[72,36,29,34],[72,37,29,34,"default"],[72,44,29,34],[72,45,29,35,"get"],[72,48,29,38],[72,49,29,39],[72,63,29,53],[72,64,29,54],[73,10,30,8,"setUser"],[73,17,30,15],[73,18,30,16,"response"],[73,26,30,24],[73,27,30,25,"data"],[73,31,30,29],[73,32,30,30],[74,8,31,6],[74,9,31,7],[74,15,31,13],[75,10,32,8,"setLoading"],[75,20,32,18],[75,21,32,19],[75,26,32,24],[75,27,32,25],[76,8,33,6],[77,6,34,4],[77,7,34,5],[77,8,34,6],[77,15,34,13,"error"],[77,20,34,18],[77,22,34,20],[78,8,35,6,"console"],[78,15,35,13],[78,16,35,14,"error"],[78,21,35,19],[78,22,35,20],[78,45,35,43],[78,47,35,45,"error"],[78,52,35,50],[78,53,35,51],[79,8,36,6],[79,14,36,12,"AsyncStorage"],[79,26,36,24],[79,27,36,24,"default"],[79,34,36,24],[79,35,36,25,"removeItem"],[79,45,36,35],[79,46,36,36],[79,61,36,51],[79,62,36,52],[80,8,37,6,"setLoading"],[80,18,37,16],[80,19,37,17],[80,24,37,22],[80,25,37,23],[81,6,38,4],[82,4,39,2],[82,5,39,3],[83,4,41,2],[83,10,41,8,"signIn"],[83,16,41,14],[83,19,41,17],[83,25,41,17,"signIn"],[83,26,41,17],[83,31,41,29],[84,6,42,4],[84,12,42,10,"redirectUrl"],[84,23,42,21],[84,26,42,24,"_expoVirtualEnv"],[84,41,42,24],[84,42,42,24,"env"],[84,45,42,24],[84,46,42,24,"EXPO_PUBLIC_REDIRECT_URL"],[84,70,42,24],[84,74,42,64],[84,121,42,111],[85,6,43,4],[85,12,43,10,"authUrl"],[85,19,43,17],[85,22,43,20],[85,66,43,64,"encodeURIComponent"],[85,84,43,82],[85,85,43,83,"redirectUrl"],[85,96,43,94],[85,97,43,95],[85,99,43,97],[86,6,45,4],[86,10,45,8],[87,8,46,6],[87,14,46,12,"result"],[87,20,46,18],[87,23,46,21],[87,29,46,27,"WebBrowser"],[87,39,46,37],[87,40,46,38,"openAuthSessionAsync"],[87,60,46,58],[87,61,46,59,"authUrl"],[87,68,46,66],[87,70,46,68,"redirectUrl"],[87,81,46,79],[87,82,46,80],[88,8,48,6],[88,12,48,10,"result"],[88,18,48,16],[88,19,48,17,"type"],[88,23,48,21],[88,28,48,26],[88,37,48,35],[88,41,48,39,"result"],[88,47,48,45],[88,48,48,46,"url"],[88,51,48,49],[88,53,48,51],[89,10,49,8],[89,16,49,14,"url"],[89,19,49,17],[89,22,49,20],[89,26,49,24,"URL"],[89,29,49,27],[89,30,49,28,"result"],[89,36,49,34],[89,37,49,35,"url"],[89,40,49,38],[89,41,49,39],[90,10,50,8],[90,16,50,14,"hash"],[90,20,50,18],[90,23,50,21,"url"],[90,26,50,24],[90,27,50,25,"hash"],[90,31,50,29],[90,32,50,30,"substring"],[90,41,50,39],[90,42,50,40],[90,43,50,41],[90,44,50,42],[91,10,51,8],[91,16,51,14,"params"],[91,22,51,20],[91,25,51,23],[91,29,51,27,"URLSearchParams"],[91,44,51,42],[91,45,51,43,"hash"],[91,49,51,47],[91,50,51,48],[92,10,52,8],[92,16,52,14,"sid"],[92,19,52,17],[92,22,52,20,"params"],[92,28,52,26],[92,29,52,27,"get"],[92,32,52,30],[92,33,52,31],[92,45,52,43],[92,46,52,44],[93,10,54,8],[93,14,54,12,"sid"],[93,17,54,15],[93,19,54,17],[94,12,55,10],[94,18,55,16,"response"],[94,26,55,24],[94,29,55,27],[94,35,55,33,"api"],[94,38,55,36],[94,39,55,36,"default"],[94,46,55,36],[94,47,55,37,"post"],[94,51,55,41],[94,52,55,42],[94,71,55,61],[94,73,55,63],[95,14,55,65,"session_id"],[95,24,55,75],[95,26,55,77,"sid"],[96,12,55,81],[96,13,55,82],[96,14,55,83],[97,12,56,10],[97,18,56,16],[98,14,56,18,"session_token"],[98,27,56,31],[99,14,56,33,"user"],[100,12,56,38],[100,13,56,39],[100,16,56,42,"response"],[100,24,56,50],[100,25,56,51,"data"],[100,29,56,55],[101,12,58,10],[101,18,58,16,"AsyncStorage"],[101,30,58,28],[101,31,58,28,"default"],[101,38,58,28],[101,39,58,29,"setItem"],[101,46,58,36],[101,47,58,37],[101,62,58,52],[101,64,58,54,"session_token"],[101,77,58,67],[101,78,58,68],[102,12,59,10,"setUser"],[102,19,59,17],[102,20,59,18,"user"],[102,24,59,22],[102,25,59,23],[103,10,60,8],[104,8,61,6],[105,6,62,4],[105,7,62,5],[105,8,62,6],[105,15,62,13,"error"],[105,20,62,18],[105,22,62,20],[106,8,63,6,"console"],[106,15,63,13],[106,16,63,14,"error"],[106,21,63,19],[106,22,63,20],[106,39,63,37],[106,41,63,39,"error"],[106,46,63,44],[106,47,63,45],[107,8,64,6],[107,14,64,12,"error"],[107,19,64,17],[108,6,65,4],[109,4,66,2],[109,5,66,3],[110,4,68,2],[110,10,68,8,"signOut"],[110,17,68,15],[110,20,68,18],[110,26,68,18,"signOut"],[110,27,68,18],[110,32,68,30],[111,6,69,4],[111,10,69,8],[112,8,70,6],[112,14,70,12,"api"],[112,17,70,15],[112,18,70,15,"default"],[112,25,70,15],[112,26,70,16,"post"],[112,30,70,20],[112,31,70,21],[112,49,70,39],[112,50,70,40],[113,8,71,6],[113,14,71,12,"AsyncStorage"],[113,26,71,24],[113,27,71,24,"default"],[113,34,71,24],[113,35,71,25,"removeItem"],[113,45,71,35],[113,46,71,36],[113,61,71,51],[113,62,71,52],[114,8,72,6,"logout"],[114,14,72,12],[114,15,72,13],[114,16,72,14],[115,6,73,4],[115,7,73,5],[115,8,73,6],[115,15,73,13,"error"],[115,20,73,18],[115,22,73,20],[116,8,74,6,"console"],[116,15,74,13],[116,16,74,14,"error"],[116,21,74,19],[116,22,74,20],[116,40,74,38],[116,42,74,40,"error"],[116,47,74,45],[116,48,74,46],[117,6,75,4],[118,4,76,2],[118,5,76,3],[119,4,78,2],[119,24,79,4],[119,28,79,4,"_reactJsxDevRuntime"],[119,47,79,4],[119,48,79,4,"jsxDEV"],[119,54,79,4],[119,56,79,5,"AuthContext"],[119,67,79,16],[119,68,79,17,"Provider"],[119,76,79,25],[120,6,79,26,"value"],[120,11,79,31],[120,13,79,33],[121,8,79,35,"signIn"],[121,14,79,41],[122,8,79,43,"signOut"],[122,15,79,50],[123,8,79,52,"isLoading"],[124,6,79,62],[124,7,79,64],[125,6,79,64,"children"],[125,14,79,64],[125,16,80,7,"children"],[126,4,80,15],[127,6,80,15,"fileName"],[127,14,80,15],[127,16,80,15,"_jsxFileName"],[127,28,80,15],[128,6,80,15,"lineNumber"],[128,16,80,15],[129,6,80,15,"columnNumber"],[129,18,80,15],[130,4,80,15],[130,11,81,26],[130,12,81,27],[131,2,83,0],[131,3,83,1],[132,2,83,2,"_s"],[132,4,83,2],[132,5,17,13,"AuthProvider"],[132,17,17,25],[133,4,17,25],[133,12,18,53,"useUserStore"],[133,27,18,65],[133,28,18,65,"useUserStore"],[133,40,18,65],[134,2,18,65],[135,2,18,65,"_c"],[135,4,18,65],[135,7,17,13,"AuthProvider"],[135,19,17,25],[136,2,85,7],[136,8,85,13,"useAuth"],[136,15,85,20],[136,18,85,23,"useAuth"],[136,19,85,23],[136,24,85,29],[137,4,85,29,"_s2"],[137,7,85,29],[138,4,86,2],[138,10,86,8,"context"],[138,17,86,15],[138,20,86,18],[138,24,86,18,"useContext"],[138,30,86,28],[138,31,86,28,"useContext"],[138,41,86,28],[138,43,86,29,"AuthContext"],[138,54,86,40],[138,55,86,41],[139,4,87,2],[139,8,87,6],[139,9,87,7,"context"],[139,16,87,14],[139,18,87,16],[140,6,88,4],[140,12,88,10],[140,16,88,14,"Error"],[140,21,88,19],[140,22,88,20],[140,64,88,62],[140,65,88,63],[141,4,89,2],[142,4,90,2],[142,11,90,9,"context"],[142,18,90,16],[143,2,91,0],[143,3,91,1],[144,2,91,2,"_s2"],[144,5,91,2],[144,6,85,13,"useAuth"],[144,13,85,20],[145,2,85,20],[145,6,85,20,"_c"],[145,8,85,20],[146,2,85,20,"$RefreshReg$"],[146,14,85,20],[146,15,85,20,"_c"],[146,17,85,20],[147,0,85,20],[147,3]],"functionMap":{"names":["<global>","AuthProvider","useEffect$argument_0","checkExistingSession","signIn","signOut","useAuth"],"mappings":"AAA;4BCgB;YCI;GDE;+BEE;GFc;iBGE;GHyB;kBIE;GJQ;CDO;uBME;CNM"},"hasCjsExports":false},"type":"js/module"}]}