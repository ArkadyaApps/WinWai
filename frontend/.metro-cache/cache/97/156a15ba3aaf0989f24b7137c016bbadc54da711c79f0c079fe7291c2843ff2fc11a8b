{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":89,"index":89}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":90},"end":{"line":2,"column":69,"index":159}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"expo-web-browser","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":160},"end":{"line":3,"column":47,"index":207}}],"key":"qFWzf28Sq0474idIhFBHQFboHaY=","exportNames":["*"],"imports":1}},{"name":"../store/userStore","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":208},"end":{"line":4,"column":50,"index":258}}],"key":"IgQi61grymUjzhOUT2rUJCaLs54=","exportNames":["*"],"imports":1}},{"name":"../utils/api","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":259},"end":{"line":5,"column":31,"index":290}}],"key":"XoJ+jbKCrEi38eKczMqtlbk+TCk=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/src/contexts/AuthContext.tsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  Object.defineProperty(exports, \"AuthProvider\", {\n    enumerable: true,\n    get: function () {\n      return AuthProvider;\n    }\n  });\n  Object.defineProperty(exports, \"useAuth\", {\n    enumerable: true,\n    get: function () {\n      return useAuth;\n    }\n  });\n  var _react = require(_dependencyMap[0], \"react\");\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[1], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _expoWebBrowser = require(_dependencyMap[2], \"expo-web-browser\");\n  var WebBrowser = _interopNamespace(_expoWebBrowser);\n  var _storeUserStore = require(_dependencyMap[3], \"../store/userStore\");\n  var _utilsApi = require(_dependencyMap[4], \"../utils/api\");\n  var api = _interopDefault(_utilsApi);\n  var _reactJsxDevRuntime = require(_dependencyMap[5], \"react/jsx-dev-runtime\");\n  WebBrowser.maybeCompleteAuthSession();\n  const AuthContext = /*#__PURE__*/(0, _react.createContext)(undefined);\n  const AuthProvider = ({\n    children\n  }) => {\n    _s();\n    const {\n      setUser,\n      setLoading,\n      logout,\n      isLoading\n    } = (0, _storeUserStore.useUserStore)();\n    const [sessionId, setSessionId] = (0, _react.useState)(null);\n    (0, _react.useEffect)(() => {\n      checkExistingSession();\n    }, []);\n    const checkExistingSession = async () => {\n      try {\n        const token = await AsyncStorage.default.getItem('session_token');\n        if (token) {\n          const response = await api.default.get('/api/auth/me');\n          setUser(response.data);\n        } else {\n          setLoading(false);\n        }\n      } catch (error) {\n        console.error('Session check failed:', error);\n        await AsyncStorage.default.removeItem('session_token');\n        setLoading(false);\n      }\n    };\n    const signIn = async () => {\n      const redirectUrl = 'https://raffleprize.preview.emergentagent.com';\n      const authUrl = `https://auth.emergentagent.com/?redirect=${encodeURIComponent(redirectUrl)}`;\n      try {\n        const result = await WebBrowser.openAuthSessionAsync(authUrl, redirectUrl);\n        if (result.type === 'success' && result.url) {\n          const url = new URL(result.url);\n          const hash = url.hash.substring(1);\n          const params = new URLSearchParams(hash);\n          const sid = params.get('session_id');\n          if (sid) {\n            const response = await api.default.post('/api/auth/session', {\n              session_id: sid\n            });\n            const {\n              session_token,\n              user\n            } = response.data;\n            await AsyncStorage.default.setItem('session_token', session_token);\n            setUser(user);\n          }\n        }\n      } catch (error) {\n        console.error('Sign in failed:', error);\n        throw error;\n      }\n    };\n    const signOut = async () => {\n      try {\n        await api.default.post('/api/auth/logout');\n        await AsyncStorage.default.removeItem('session_token');\n        logout();\n      } catch (error) {\n        console.error('Sign out failed:', error);\n      }\n    };\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(AuthContext.Provider, {\n      value: {\n        signIn,\n        signOut,\n        isLoading\n      },\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 5\n    }, this);\n  };\n  _s(AuthProvider, \"tyUP7gYx00Tp5ERuwaT0q49JUHI=\", false, function () {\n    return [_storeUserStore.useUserStore];\n  });\n  _c = AuthProvider;\n  const useAuth = () => {\n    _s2();\n    const context = (0, _react.useContext)(AuthContext);\n    if (!context) {\n      throw new Error('useAuth must be used within AuthProvider');\n    }\n    return context;\n  };\n  _s2(useAuth, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\n  var _c;\n  $RefreshReg$(_c, \"AuthProvider\");\n});","lineCount":146,"map":[[30,2,17,0,"Object"],[30,8,17,0],[30,9,17,0,"defineProperty"],[30,23,17,0],[30,24,17,0,"exports"],[30,31,17,0],[31,4,17,0,"enumerable"],[31,14,17,0],[32,4,17,0,"get"],[32,7,17,0],[32,18,17,0,"get"],[32,19,17,0],[33,6,17,0],[33,13,17,0,"AuthProvider"],[33,25,17,0],[34,4,17,0],[35,2,17,0],[36,2,85,0,"Object"],[36,8,85,0],[36,9,85,0,"defineProperty"],[36,23,85,0],[36,24,85,0,"exports"],[36,31,85,0],[37,4,85,0,"enumerable"],[37,14,85,0],[38,4,85,0,"get"],[38,7,85,0],[38,18,85,0,"get"],[38,19,85,0],[39,6,85,0],[39,13,85,0,"useAuth"],[39,20,85,0],[40,4,85,0],[41,2,85,0],[42,2,1,0],[42,6,1,0,"_react"],[42,12,1,0],[42,15,1,0,"require"],[42,22,1,0],[42,23,1,0,"_dependencyMap"],[42,37,1,0],[43,2,2,0],[43,6,2,0,"_reactNativeAsyncStorageAsyncStorage"],[43,42,2,0],[43,45,2,0,"require"],[43,52,2,0],[43,53,2,0,"_dependencyMap"],[43,67,2,0],[44,2,2,0],[44,6,2,0,"AsyncStorage"],[44,18,2,0],[44,21,2,0,"_interopDefault"],[44,36,2,0],[44,37,2,0,"_reactNativeAsyncStorageAsyncStorage"],[44,73,2,0],[45,2,3,0],[45,6,3,0,"_expoWebBrowser"],[45,21,3,0],[45,24,3,0,"require"],[45,31,3,0],[45,32,3,0,"_dependencyMap"],[45,46,3,0],[46,2,3,0],[46,6,3,0,"WebBrowser"],[46,16,3,0],[46,19,3,0,"_interopNamespace"],[46,36,3,0],[46,37,3,0,"_expoWebBrowser"],[46,52,3,0],[47,2,4,0],[47,6,4,0,"_storeUserStore"],[47,21,4,0],[47,24,4,0,"require"],[47,31,4,0],[47,32,4,0,"_dependencyMap"],[47,46,4,0],[48,2,5,0],[48,6,5,0,"_utilsApi"],[48,15,5,0],[48,18,5,0,"require"],[48,25,5,0],[48,26,5,0,"_dependencyMap"],[48,40,5,0],[49,2,5,0],[49,6,5,0,"api"],[49,9,5,0],[49,12,5,0,"_interopDefault"],[49,27,5,0],[49,28,5,0,"_utilsApi"],[49,37,5,0],[50,2,5,31],[50,6,5,31,"_reactJsxDevRuntime"],[50,25,5,31],[50,28,5,31,"require"],[50,35,5,31],[50,36,5,31,"_dependencyMap"],[50,50,5,31],[51,2,7,0,"WebBrowser"],[51,12,7,10],[51,13,7,11,"maybeCompleteAuthSession"],[51,37,7,35],[51,38,7,36],[51,39,7,37],[52,2,15,0],[52,8,15,6,"AuthContext"],[52,19,15,17],[52,35,15,20],[52,39,15,20,"createContext"],[52,45,15,33],[52,46,15,33,"createContext"],[52,59,15,33],[52,61,15,63,"undefined"],[52,70,15,72],[52,71,15,73],[53,2,17,7],[53,8,17,13,"AuthProvider"],[53,20,17,25],[53,23,17,28,"AuthProvider"],[53,24,17,29],[54,4,17,31,"children"],[55,2,17,65],[55,3,17,66],[55,8,17,71],[56,4,17,71,"_s"],[56,6,17,71],[57,4,18,2],[57,10,18,8],[58,6,18,10,"setUser"],[58,13,18,17],[59,6,18,19,"setLoading"],[59,16,18,29],[60,6,18,31,"logout"],[60,12,18,37],[61,6,18,39,"isLoading"],[62,4,18,49],[62,5,18,50],[62,8,18,53],[62,12,18,53,"useUserStore"],[62,27,18,65],[62,28,18,65,"useUserStore"],[62,40,18,65],[62,42,18,66],[62,43,18,67],[63,4,19,2],[63,10,19,8],[63,11,19,9,"sessionId"],[63,20,19,18],[63,22,19,20,"setSessionId"],[63,34,19,32],[63,35,19,33],[63,38,19,36],[63,42,19,36,"useState"],[63,48,19,44],[63,49,19,44,"useState"],[63,57,19,44],[63,59,19,60],[63,63,19,64],[63,64,19,65],[64,4,21,2],[64,8,21,2,"useEffect"],[64,14,21,11],[64,15,21,11,"useEffect"],[64,24,21,11],[64,26,21,12],[64,32,21,18],[65,6,22,4,"checkExistingSession"],[65,26,22,24],[65,27,22,25],[65,28,22,26],[66,4,23,2],[66,5,23,3],[66,7,23,5],[66,9,23,7],[66,10,23,8],[67,4,25,2],[67,10,25,8,"checkExistingSession"],[67,30,25,28],[67,33,25,31],[67,39,25,31,"checkExistingSession"],[67,40,25,31],[67,45,25,43],[68,6,26,4],[68,10,26,8],[69,8,27,6],[69,14,27,12,"token"],[69,19,27,17],[69,22,27,20],[69,28,27,26,"AsyncStorage"],[69,40,27,38],[69,41,27,38,"default"],[69,48,27,38],[69,49,27,39,"getItem"],[69,56,27,46],[69,57,27,47],[69,72,27,62],[69,73,27,63],[70,8,28,6],[70,12,28,10,"token"],[70,17,28,15],[70,19,28,17],[71,10,29,8],[71,16,29,14,"response"],[71,24,29,22],[71,27,29,25],[71,33,29,31,"api"],[71,36,29,34],[71,37,29,34,"default"],[71,44,29,34],[71,45,29,35,"get"],[71,48,29,38],[71,49,29,39],[71,63,29,53],[71,64,29,54],[72,10,30,8,"setUser"],[72,17,30,15],[72,18,30,16,"response"],[72,26,30,24],[72,27,30,25,"data"],[72,31,30,29],[72,32,30,30],[73,8,31,6],[73,9,31,7],[73,15,31,13],[74,10,32,8,"setLoading"],[74,20,32,18],[74,21,32,19],[74,26,32,24],[74,27,32,25],[75,8,33,6],[76,6,34,4],[76,7,34,5],[76,8,34,6],[76,15,34,13,"error"],[76,20,34,18],[76,22,34,20],[77,8,35,6,"console"],[77,15,35,13],[77,16,35,14,"error"],[77,21,35,19],[77,22,35,20],[77,45,35,43],[77,47,35,45,"error"],[77,52,35,50],[77,53,35,51],[78,8,36,6],[78,14,36,12,"AsyncStorage"],[78,26,36,24],[78,27,36,24,"default"],[78,34,36,24],[78,35,36,25,"removeItem"],[78,45,36,35],[78,46,36,36],[78,61,36,51],[78,62,36,52],[79,8,37,6,"setLoading"],[79,18,37,16],[79,19,37,17],[79,24,37,22],[79,25,37,23],[80,6,38,4],[81,4,39,2],[81,5,39,3],[82,4,41,2],[82,10,41,8,"signIn"],[82,16,41,14],[82,19,41,17],[82,25,41,17,"signIn"],[82,26,41,17],[82,31,41,29],[83,6,42,4],[83,12,42,10,"redirectUrl"],[83,23,42,21],[83,26,42,24],[83,73,42,71],[84,6,43,4],[84,12,43,10,"authUrl"],[84,19,43,17],[84,22,43,20],[84,66,43,64,"encodeURIComponent"],[84,84,43,82],[84,85,43,83,"redirectUrl"],[84,96,43,94],[84,97,43,95],[84,99,43,97],[85,6,45,4],[85,10,45,8],[86,8,46,6],[86,14,46,12,"result"],[86,20,46,18],[86,23,46,21],[86,29,46,27,"WebBrowser"],[86,39,46,37],[86,40,46,38,"openAuthSessionAsync"],[86,60,46,58],[86,61,46,59,"authUrl"],[86,68,46,66],[86,70,46,68,"redirectUrl"],[86,81,46,79],[86,82,46,80],[87,8,48,6],[87,12,48,10,"result"],[87,18,48,16],[87,19,48,17,"type"],[87,23,48,21],[87,28,48,26],[87,37,48,35],[87,41,48,39,"result"],[87,47,48,45],[87,48,48,46,"url"],[87,51,48,49],[87,53,48,51],[88,10,49,8],[88,16,49,14,"url"],[88,19,49,17],[88,22,49,20],[88,26,49,24,"URL"],[88,29,49,27],[88,30,49,28,"result"],[88,36,49,34],[88,37,49,35,"url"],[88,40,49,38],[88,41,49,39],[89,10,50,8],[89,16,50,14,"hash"],[89,20,50,18],[89,23,50,21,"url"],[89,26,50,24],[89,27,50,25,"hash"],[89,31,50,29],[89,32,50,30,"substring"],[89,41,50,39],[89,42,50,40],[89,43,50,41],[89,44,50,42],[90,10,51,8],[90,16,51,14,"params"],[90,22,51,20],[90,25,51,23],[90,29,51,27,"URLSearchParams"],[90,44,51,42],[90,45,51,43,"hash"],[90,49,51,47],[90,50,51,48],[91,10,52,8],[91,16,52,14,"sid"],[91,19,52,17],[91,22,52,20,"params"],[91,28,52,26],[91,29,52,27,"get"],[91,32,52,30],[91,33,52,31],[91,45,52,43],[91,46,52,44],[92,10,54,8],[92,14,54,12,"sid"],[92,17,54,15],[92,19,54,17],[93,12,55,10],[93,18,55,16,"response"],[93,26,55,24],[93,29,55,27],[93,35,55,33,"api"],[93,38,55,36],[93,39,55,36,"default"],[93,46,55,36],[93,47,55,37,"post"],[93,51,55,41],[93,52,55,42],[93,71,55,61],[93,73,55,63],[94,14,55,65,"session_id"],[94,24,55,75],[94,26,55,77,"sid"],[95,12,55,81],[95,13,55,82],[95,14,55,83],[96,12,56,10],[96,18,56,16],[97,14,56,18,"session_token"],[97,27,56,31],[98,14,56,33,"user"],[99,12,56,38],[99,13,56,39],[99,16,56,42,"response"],[99,24,56,50],[99,25,56,51,"data"],[99,29,56,55],[100,12,58,10],[100,18,58,16,"AsyncStorage"],[100,30,58,28],[100,31,58,28,"default"],[100,38,58,28],[100,39,58,29,"setItem"],[100,46,58,36],[100,47,58,37],[100,62,58,52],[100,64,58,54,"session_token"],[100,77,58,67],[100,78,58,68],[101,12,59,10,"setUser"],[101,19,59,17],[101,20,59,18,"user"],[101,24,59,22],[101,25,59,23],[102,10,60,8],[103,8,61,6],[104,6,62,4],[104,7,62,5],[104,8,62,6],[104,15,62,13,"error"],[104,20,62,18],[104,22,62,20],[105,8,63,6,"console"],[105,15,63,13],[105,16,63,14,"error"],[105,21,63,19],[105,22,63,20],[105,39,63,37],[105,41,63,39,"error"],[105,46,63,44],[105,47,63,45],[106,8,64,6],[106,14,64,12,"error"],[106,19,64,17],[107,6,65,4],[108,4,66,2],[108,5,66,3],[109,4,68,2],[109,10,68,8,"signOut"],[109,17,68,15],[109,20,68,18],[109,26,68,18,"signOut"],[109,27,68,18],[109,32,68,30],[110,6,69,4],[110,10,69,8],[111,8,70,6],[111,14,70,12,"api"],[111,17,70,15],[111,18,70,15,"default"],[111,25,70,15],[111,26,70,16,"post"],[111,30,70,20],[111,31,70,21],[111,49,70,39],[111,50,70,40],[112,8,71,6],[112,14,71,12,"AsyncStorage"],[112,26,71,24],[112,27,71,24,"default"],[112,34,71,24],[112,35,71,25,"removeItem"],[112,45,71,35],[112,46,71,36],[112,61,71,51],[112,62,71,52],[113,8,72,6,"logout"],[113,14,72,12],[113,15,72,13],[113,16,72,14],[114,6,73,4],[114,7,73,5],[114,8,73,6],[114,15,73,13,"error"],[114,20,73,18],[114,22,73,20],[115,8,74,6,"console"],[115,15,74,13],[115,16,74,14,"error"],[115,21,74,19],[115,22,74,20],[115,40,74,38],[115,42,74,40,"error"],[115,47,74,45],[115,48,74,46],[116,6,75,4],[117,4,76,2],[117,5,76,3],[118,4,78,2],[118,24,79,4],[118,28,79,4,"_reactJsxDevRuntime"],[118,47,79,4],[118,48,79,4,"jsxDEV"],[118,54,79,4],[118,56,79,5,"AuthContext"],[118,67,79,16],[118,68,79,17,"Provider"],[118,76,79,25],[119,6,79,26,"value"],[119,11,79,31],[119,13,79,33],[120,8,79,35,"signIn"],[120,14,79,41],[121,8,79,43,"signOut"],[121,15,79,50],[122,8,79,52,"isLoading"],[123,6,79,62],[123,7,79,64],[124,6,79,64,"children"],[124,14,79,64],[124,16,80,7,"children"],[125,4,80,15],[126,6,80,15,"fileName"],[126,14,80,15],[126,16,80,15,"_jsxFileName"],[126,28,80,15],[127,6,80,15,"lineNumber"],[127,16,80,15],[128,6,80,15,"columnNumber"],[128,18,80,15],[129,4,80,15],[129,11,81,26],[129,12,81,27],[130,2,83,0],[130,3,83,1],[131,2,83,2,"_s"],[131,4,83,2],[131,5,17,13,"AuthProvider"],[131,17,17,25],[132,4,17,25],[132,12,18,53,"useUserStore"],[132,27,18,65],[132,28,18,65,"useUserStore"],[132,40,18,65],[133,2,18,65],[134,2,18,65,"_c"],[134,4,18,65],[134,7,17,13,"AuthProvider"],[134,19,17,25],[135,2,85,7],[135,8,85,13,"useAuth"],[135,15,85,20],[135,18,85,23,"useAuth"],[135,19,85,23],[135,24,85,29],[136,4,85,29,"_s2"],[136,7,85,29],[137,4,86,2],[137,10,86,8,"context"],[137,17,86,15],[137,20,86,18],[137,24,86,18,"useContext"],[137,30,86,28],[137,31,86,28,"useContext"],[137,41,86,28],[137,43,86,29,"AuthContext"],[137,54,86,40],[137,55,86,41],[138,4,87,2],[138,8,87,6],[138,9,87,7,"context"],[138,16,87,14],[138,18,87,16],[139,6,88,4],[139,12,88,10],[139,16,88,14,"Error"],[139,21,88,19],[139,22,88,20],[139,64,88,62],[139,65,88,63],[140,4,89,2],[141,4,90,2],[141,11,90,9,"context"],[141,18,90,16],[142,2,91,0],[142,3,91,1],[143,2,91,2,"_s2"],[143,5,91,2],[143,6,85,13,"useAuth"],[143,13,85,20],[144,2,85,20],[144,6,85,20,"_c"],[144,8,85,20],[145,2,85,20,"$RefreshReg$"],[145,14,85,20],[145,15,85,20,"_c"],[145,17,85,20],[146,0,85,20],[146,3]],"functionMap":{"names":["<global>","AuthProvider","useEffect$argument_0","checkExistingSession","signIn","signOut","useAuth"],"mappings":"AAA;4BCgB;YCI;GDE;+BEE;GFc;iBGE;GHyB;kBIE;GJQ;CDO;uBME;CNM"},"hasCjsExports":false},"type":"js/module"}]}