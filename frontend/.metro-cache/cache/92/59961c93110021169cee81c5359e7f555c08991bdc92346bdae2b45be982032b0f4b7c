{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"asyncType":null,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":62,"column":47,"index":2020}}],"key":"7kvm5yrOpz4NYiDi6sn4qxa8DVQ="}},{"name":"./ExpoLocation","data":{"asyncType":null,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":42,"index":42}}],"key":"NazjAXvjzikX33zTD6JfXGTtbHU="}},{"name":"./LocationEventEmitter","data":{"asyncType":null,"locs":[{"start":{"line":2,"column":0,"index":43},"end":{"line":2,"column":62,"index":105}}],"key":"3nkM0UbMG96D7lMzV9dZbSswD1Y="}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = require(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.LocationSubscriber = exports.HeadingSubscriber = void 0;\n  exports._getCurrentWatchId = _getCurrentWatchId;\n  var _ExpoLocation = _interopRequireDefault(require(_dependencyMap[1], \"./ExpoLocation\"));\n  var _LocationEventEmitter = require(_dependencyMap[2], \"./LocationEventEmitter\");\n  let nextWatchId = 0;\n  class Subscriber {\n    callbacks = {};\n    eventSubscription = null;\n    constructor(eventName, eventDataField) {\n      this.eventName = eventName;\n      this.eventDataField = eventDataField;\n    }\n    maybeInitializeSubscription() {\n      if (this.eventSubscription) {\n        return;\n      }\n      this.eventSubscription = _LocationEventEmitter.LocationEventEmitter.addListener(this.eventName, event => this.trigger(event));\n    }\n    /**\n     * Registers given callback under new id which is then returned.\n     */\n    registerCallback(callback) {\n      this.maybeInitializeSubscription();\n      const id = ++nextWatchId;\n      this.callbacks[id] = callback;\n      return id;\n    }\n    /**\n     * Unregisters a callback with given id and revokes the subscription if possible.\n     */\n    unregisterCallback(id) {\n      // Do nothing if we have already unregistered the callback.\n      if (!this.callbacks[id]) {\n        return;\n      }\n      delete this.callbacks[id];\n      _ExpoLocation.default.removeWatchAsync(id);\n      if (Object.keys(this.callbacks).length === 0 && this.eventSubscription) {\n        _LocationEventEmitter.LocationEventEmitter.removeSubscription(this.eventSubscription);\n        this.eventSubscription = null;\n      }\n    }\n    trigger(event) {\n      const watchId = event.watchId;\n      const callback = this.callbacks[watchId];\n      if (callback) {\n        callback(event[this.eventDataField]);\n      } else {\n        _ExpoLocation.default.removeWatchAsync(watchId);\n      }\n    }\n  }\n  const LocationSubscriber = exports.LocationSubscriber = new Subscriber('Expo.locationChanged', 'location');\n  const HeadingSubscriber = exports.HeadingSubscriber = new Subscriber('Expo.headingChanged', 'heading');\n  /**\n   * @private Necessary for some unit tests.\n   */\n  function _getCurrentWatchId() {\n    return nextWatchId;\n  }\n});","lineCount":66,"map":[[8,2,1,0],[8,6,1,0,"_ExpoLocation"],[8,19,1,0],[8,22,1,0,"_interopRequireDefault"],[8,44,1,0],[8,45,1,0,"require"],[8,52,1,0],[8,53,1,0,"_dependencyMap"],[8,67,1,0],[9,2,2,0],[9,6,2,0,"_LocationEventEmitter"],[9,27,2,0],[9,30,2,0,"require"],[9,37,2,0],[9,38,2,0,"_dependencyMap"],[9,52,2,0],[10,2,3,0],[10,6,3,4,"nextWatchId"],[10,17,3,15],[10,20,3,18],[10,21,3,19],[11,2,4,0],[11,8,4,6,"Subscriber"],[11,18,4,16],[11,19,4,17],[12,4,7,4,"callbacks"],[12,13,7,13],[12,16,7,16],[12,17,7,17],[12,18,7,18],[13,4,8,4,"eventSubscription"],[13,21,8,21],[13,24,8,24],[13,28,8,28],[14,4,9,4,"constructor"],[14,15,9,15,"constructor"],[14,16,9,16,"eventName"],[14,25,9,25],[14,27,9,27,"eventDataField"],[14,41,9,41],[14,43,9,43],[15,6,10,8],[15,10,10,12],[15,11,10,13,"eventName"],[15,20,10,22],[15,23,10,25,"eventName"],[15,32,10,34],[16,6,11,8],[16,10,11,12],[16,11,11,13,"eventDataField"],[16,25,11,27],[16,28,11,30,"eventDataField"],[16,42,11,44],[17,4,12,4],[18,4,13,4,"maybeInitializeSubscription"],[18,31,13,31,"maybeInitializeSubscription"],[18,32,13,31],[18,34,13,34],[19,6,14,8],[19,10,14,12],[19,14,14,16],[19,15,14,17,"eventSubscription"],[19,32,14,34],[19,34,14,36],[20,8,15,12],[21,6,16,8],[22,6,17,8],[22,10,17,12],[22,11,17,13,"eventSubscription"],[22,28,17,30],[22,31,17,33,"LocationEventEmitter"],[22,73,17,53],[22,74,17,54,"addListener"],[22,85,17,65],[22,86,17,66],[22,90,17,70],[22,91,17,71,"eventName"],[22,100,17,80],[22,102,17,83,"event"],[22,107,17,88],[22,111,17,93],[22,115,17,97],[22,116,17,98,"trigger"],[22,123,17,105],[22,124,17,106,"event"],[22,129,17,111],[22,130,17,112],[22,131,17,113],[23,4,18,4],[24,4,19,4],[25,0,20,0],[26,0,21,0],[27,4,22,4,"registerCallback"],[27,20,22,20,"registerCallback"],[27,21,22,21,"callback"],[27,29,22,29],[27,31,22,31],[28,6,23,8],[28,10,23,12],[28,11,23,13,"maybeInitializeSubscription"],[28,38,23,40],[28,39,23,41],[28,40,23,42],[29,6,24,8],[29,12,24,14,"id"],[29,14,24,16],[29,17,24,19],[29,19,24,21,"nextWatchId"],[29,30,24,32],[30,6,25,8],[30,10,25,12],[30,11,25,13,"callbacks"],[30,20,25,22],[30,21,25,23,"id"],[30,23,25,25],[30,24,25,26],[30,27,25,29,"callback"],[30,35,25,37],[31,6,26,8],[31,13,26,15,"id"],[31,15,26,17],[32,4,27,4],[33,4,28,4],[34,0,29,0],[35,0,30,0],[36,4,31,4,"unregisterCallback"],[36,22,31,22,"unregisterCallback"],[36,23,31,23,"id"],[36,25,31,25],[36,27,31,27],[37,6,32,8],[38,6,33,8],[38,10,33,12],[38,11,33,13],[38,15,33,17],[38,16,33,18,"callbacks"],[38,25,33,27],[38,26,33,28,"id"],[38,28,33,30],[38,29,33,31],[38,31,33,33],[39,8,34,12],[40,6,35,8],[41,6,36,8],[41,13,36,15],[41,17,36,19],[41,18,36,20,"callbacks"],[41,27,36,29],[41,28,36,30,"id"],[41,30,36,32],[41,31,36,33],[42,6,37,8,"ExpoLocation"],[42,27,37,20],[42,28,37,21,"removeWatchAsync"],[42,44,37,37],[42,45,37,38,"id"],[42,47,37,40],[42,48,37,41],[43,6,38,8],[43,10,38,12,"Object"],[43,16,38,18],[43,17,38,19,"keys"],[43,21,38,23],[43,22,38,24],[43,26,38,28],[43,27,38,29,"callbacks"],[43,36,38,38],[43,37,38,39],[43,38,38,40,"length"],[43,44,38,46],[43,49,38,51],[43,50,38,52],[43,54,38,56],[43,58,38,60],[43,59,38,61,"eventSubscription"],[43,76,38,78],[43,78,38,80],[44,8,39,12,"LocationEventEmitter"],[44,50,39,32],[44,51,39,33,"removeSubscription"],[44,69,39,51],[44,70,39,52],[44,74,39,56],[44,75,39,57,"eventSubscription"],[44,92,39,74],[44,93,39,75],[45,8,40,12],[45,12,40,16],[45,13,40,17,"eventSubscription"],[45,30,40,34],[45,33,40,37],[45,37,40,41],[46,6,41,8],[47,4,42,4],[48,4,43,4,"trigger"],[48,11,43,11,"trigger"],[48,12,43,12,"event"],[48,17,43,17],[48,19,43,19],[49,6,44,8],[49,12,44,14,"watchId"],[49,19,44,21],[49,22,44,24,"event"],[49,27,44,29],[49,28,44,30,"watchId"],[49,35,44,37],[50,6,45,8],[50,12,45,14,"callback"],[50,20,45,22],[50,23,45,25],[50,27,45,29],[50,28,45,30,"callbacks"],[50,37,45,39],[50,38,45,40,"watchId"],[50,45,45,47],[50,46,45,48],[51,6,46,8],[51,10,46,12,"callback"],[51,18,46,20],[51,20,46,22],[52,8,47,12,"callback"],[52,16,47,20],[52,17,47,21,"event"],[52,22,47,26],[52,23,47,27],[52,27,47,31],[52,28,47,32,"eventDataField"],[52,42,47,46],[52,43,47,47],[52,44,47,48],[53,6,48,8],[53,7,48,9],[53,13,49,13],[54,8,50,12,"ExpoLocation"],[54,29,50,24],[54,30,50,25,"removeWatchAsync"],[54,46,50,41],[54,47,50,42,"watchId"],[54,54,50,49],[54,55,50,50],[55,6,51,8],[56,4,52,4],[57,2,53,0],[58,2,54,7],[58,8,54,13,"LocationSubscriber"],[58,26,54,31],[58,29,54,31,"exports"],[58,36,54,31],[58,37,54,31,"LocationSubscriber"],[58,55,54,31],[58,58,54,34],[58,62,54,38,"Subscriber"],[58,72,54,48],[58,73,54,49],[58,95,54,71],[58,97,54,73],[58,107,54,83],[58,108,54,84],[59,2,55,7],[59,8,55,13,"HeadingSubscriber"],[59,25,55,30],[59,28,55,30,"exports"],[59,35,55,30],[59,36,55,30,"HeadingSubscriber"],[59,53,55,30],[59,56,55,33],[59,60,55,37,"Subscriber"],[59,70,55,47],[59,71,55,48],[59,92,55,69],[59,94,55,71],[59,103,55,80],[59,104,55,81],[60,2,56,0],[61,0,57,0],[62,0,58,0],[63,2,59,7],[63,11,59,16,"_getCurrentWatchId"],[63,29,59,34,"_getCurrentWatchId"],[63,30,59,34],[63,32,59,37],[64,4,60,4],[64,11,60,11,"nextWatchId"],[64,22,60,22],[65,2,61,0],[66,0,61,1]],"functionMap":{"names":["<global>","Subscriber","Subscriber#constructor","Subscriber#maybeInitializeSubscription","LocationEventEmitter.addListener$argument_1","Subscriber#registerCallback","Subscriber#unregisterCallback","Subscriber#trigger","_getCurrentWatchId"],"mappings":"AAA;ACG;ICK;KDG;IEC;kFCI,8BD;KFC;III;KJK;IKI;KLW;IMC;KNS;CDC;OQM;CRE"}},"type":"js/module"}]}